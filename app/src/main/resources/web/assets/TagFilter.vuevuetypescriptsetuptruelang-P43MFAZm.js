import{_ as U}from"./VDropdownMenu-qVpzzrhB.js";import{d as z,u as F,e as j,r as m,g as x,bC as J,G as O,az as P,ac as u,aA as R,c as p,o as l,a as n,j as _,I as Z,Z as w,t as d,a0 as K,O as T,H as W,A as v,v as g,cE as X,V as E,U as Y,T as ee,bR as te,ab as f,b_ as M,ax as ae,D as ne,C as oe,cG as se,E as ie,i as B,cH as le,cI as de,cJ as ce}from"./index-DLxHt1vi.js";const re={class:"section-title"},ue={class:"nav"},me=["onClick"],pe={class:"title"},_e={class:"count"},fe=z({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(y){const o=y,{t:s}=F(),G=j(),h=m([]),i=m(!1),c=m(),{refetch:r}=x({handle:(e,t)=>{t?O(s(t),"error"):e&&(h.value=e.tags)},document:J,variables:{type:o.type}});function I(e){c.value=e;const t=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:t}})),i.value=!0}function L(e){f(M,{title:s("rename"),placeholder:s("name"),value:e.name,mutation:()=>B({document:le}),getVariables:t=>({id:e.id,name:t}),done:()=>{r()}})}function Q(e){f(ae,{id:e.id,name:e.name,gql:de,typeName:"Tag"})}function S(){f(M,{title:s("add_tag"),placeholder:s("name"),mutation:()=>B({document:ce,options:{update:()=>{r()}}}),getVariables:e=>({type:o.type,name:e})})}function q(e){const t=ne([{name:"tag_id",op:"",value:e.id}]);oe(G,`/${se[o.type]}?q=${ie(t)}`)}const C=e=>{e===o.type&&r()},b=e=>{e.type===o.type&&r()};return P(()=>{u.on("refetch_tags",C),u.on("media_items_actioned",b)}),R(()=>{u.off("refetch_tags",C),u.off("media_items_actioned",b)}),(e,t)=>{var V;const D=X,$=W,H=te,N=U,k=K("tooltip");return l(),p(E,null,[n("div",re,[Z(d(e.$t("tags"))+" ",1),w((l(),T($,{onClick:v(S,["prevent"])},{default:g(()=>[_(D)]),_:1})),[[k,e.$t("add_tag")]])]),n("ul",ue,[(l(!0),p(E,null,Y(h.value,a=>(l(),p("li",{key:a.id,class:ee({active:a.id===y.selected}),onClick:v(A=>q(a),["prevent"])},[n("span",pe,d(a.name),1),w((l(),T($,{id:"tag-"+a.id,class:"sm",onClick:v(A=>I(a),["prevent","stop"])},{default:g(()=>[_(H)]),_:2},1032,["id","onClick"])),[[k,e.$t("actions")]]),n("span",_e,d(a.count.toLocaleString()),1)],10,me))),128))]),_(N,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),anchor:"tag-"+((V=c.value)==null?void 0:V.id)},{default:g(()=>[n("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>{L(c.value),i.value=!1})},d(e.$t("rename")),1),n("div",{class:"dropdown-item",onClick:t[1]||(t[1]=a=>{Q(c.value),i.value=!1})},d(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{fe as _};
