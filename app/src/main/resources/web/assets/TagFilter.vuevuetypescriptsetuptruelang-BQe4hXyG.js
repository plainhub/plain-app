import{_ as x}from"./VDropdownMenu-DdmjILN8.js";import{_ as z}from"./more-vert-COB1t_KV.js";import{m as A,c as m,o as s,a as o,d as U,u as j,e as O,r as _,g as P,bF as R,G as W,az as J,ac as u,aA as K,j as v,I as X,$ as b,t as d,a1 as Y,O as V,H as Z,A as g,v as f,W as q,U as ee,T as te,ab as h,c1 as M,ax as ae,D as ne,C as oe,cF as se,E as ie,i as B,cG as le,cH as de,cI as re}from"./index-Bsb9VlRU.js";const ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ue(p,n){return s(),m("svg",ce,n[0]||(n[0]=[o("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const me=A({name:"material-symbols-add-rounded",render:ue}),pe={class:"section-title"},_e={class:"nav"},ve=["onClick"],ge={class:"title"},fe={class:"count"},Ce=U({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(p){const n=p,{t:i}=j(),E=O(),y=_([]),l=_(!1),r=_(),{refetch:c}=P({handle:(e,t)=>{t?W(i(t),"error"):e&&(y.value=e.tags)},document:R,variables:{type:n.type}});function G(e){r.value=e;const t=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:t}})),l.value=!0}function I(e){h(M,{title:i("rename"),placeholder:i("name"),value:e.name,mutation:()=>B({document:le}),getVariables:t=>({id:e.id,name:t}),done:()=>{c()}})}function L(e){h(ae,{id:e.id,name:e.name,gql:de,typeName:"Tag"})}function Q(){h(M,{title:i("add_tag"),placeholder:i("name"),mutation:()=>B({document:re,options:{update:()=>{c()}}}),getVariables:e=>({type:n.type,name:e})})}function S(e){const t=ne([{name:"tag_id",op:"",value:e.id}]);oe(E,`/${se[n.type]}?q=${ie(t)}`)}const T=e=>{e===n.type&&c()},C=e=>{e.type===n.type&&c()};return J(()=>{u.on("refetch_tags",T),u.on("media_items_actioned",C)}),K(()=>{u.off("refetch_tags",T),u.off("media_items_actioned",C)}),(e,t)=>{var k;const D=me,$=Z,H=z,F=x,w=Y("tooltip");return s(),m(q,null,[o("div",pe,[X(d(e.$t("tags"))+" ",1),b((s(),V($,{onClick:g(Q,["prevent"])},{default:f(()=>[v(D)]),_:1})),[[w,e.$t("add_tag")]])]),o("ul",_e,[(s(!0),m(q,null,ee(y.value,a=>(s(),m("li",{key:a.id,class:te({active:a.id===p.selected}),onClick:g(N=>S(a),["prevent"])},[o("span",ge,d(a.name),1),b((s(),V($,{id:"tag-"+a.id,class:"sm",onClick:g(N=>G(a),["prevent","stop"])},{default:f(()=>[v(H)]),_:2},1032,["id","onClick"])),[[w,e.$t("actions")]]),o("span",fe,d(a.count.toLocaleString()),1)],10,ve))),128))]),v(F,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),anchor:"tag-"+((k=r.value)==null?void 0:k.id)},{default:f(()=>[o("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>{I(r.value),l.value=!1})},d(e.$t("rename")),1),o("div",{class:"dropdown-item",onClick:t[1]||(t[1]=a=>{L(r.value),l.value=!1})},d(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{Ce as _,me as a};
