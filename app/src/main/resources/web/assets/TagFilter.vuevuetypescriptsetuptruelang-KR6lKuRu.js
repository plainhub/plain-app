import{_ as U}from"./VDropdownMenu-BCHmjly-.js";import{d as F,u as j,e as z,r as m,g as J,bG as K,G as O,aA as P,ad as u,aB as W,c as p,o as l,a as n,j as _,I as x,$ as w,t as d,a1 as R,O as T,H as X,A as v,v as g,cH as Y,W as M,U as Z,T as ee,bV as te,ac as f,c3 as B,ay as ae,D as ne,C as oe,cJ as se,E as ie,i as E,cK as le,cL as de,cM as ce}from"./index-9yvO6RpE.js";const re={class:"section-title"},ue={class:"nav"},me=["onClick"],pe={class:"title"},_e={class:"count"},fe=F({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(y){const o=y,{t:s}=j(),L=z(),h=m([]),i=m(!1),c=m(),{refetch:r}=J({handle:(e,t)=>{t?O(s(t),"error"):e&&(h.value=e.tags)},document:K,variables:{type:o.type}});function G(e){c.value=e;const t=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:t}})),i.value=!0}function Q(e){f(B,{title:s("rename"),placeholder:s("name"),value:e.name,mutation:()=>E({document:le}),getVariables:t=>({id:e.id,name:t}),done:()=>{r()}})}function S(e){f(ae,{id:e.id,name:e.name,gql:de,typeName:"Tag"})}function q(){f(B,{title:s("add_tag"),placeholder:s("name"),mutation:()=>E({document:ce,options:{update:()=>{r()}}}),getVariables:e=>({type:o.type,name:e})})}function D(e){const t=ne([{name:"tag_id",op:"",value:e.id}]);oe(L,`/${se[o.type]}?q=${ie(t)}`)}const C=e=>{e===o.type&&r()},$=e=>{e.type===o.type&&r()};return P(()=>{u.on("refetch_tags",C),u.on("media_items_actioned",$)}),W(()=>{u.off("refetch_tags",C),u.off("media_items_actioned",$)}),(e,t)=>{var b;const I=Y,k=X,H=te,N=U,V=R("tooltip");return l(),p(M,null,[n("div",re,[x(d(e.$t("tags"))+" ",1),w((l(),T(k,{onClick:v(q,["prevent"])},{default:g(()=>[_(I)]),_:1})),[[V,e.$t("add_tag")]])]),n("ul",ue,[(l(!0),p(M,null,Z(h.value,a=>(l(),p("li",{key:a.id,class:ee({active:a.id===y.selected}),onClick:v(A=>D(a),["prevent"])},[n("span",pe,d(a.name),1),w((l(),T(k,{id:"tag-"+a.id,class:"sm",onClick:v(A=>G(a),["prevent","stop"])},{default:g(()=>[_(H)]),_:2},1032,["id","onClick"])),[[V,e.$t("actions")]]),n("span",_e,d(a.count.toLocaleString()),1)],10,me))),128))]),_(N,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=a=>i.value=a),anchor:"tag-"+((b=c.value)==null?void 0:b.id)},{default:g(()=>[n("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>{Q(c.value),i.value=!1})},d(e.$t("rename")),1),n("div",{class:"dropdown-item",onClick:t[1]||(t[1]=a=>{S(c.value),i.value=!1})},d(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{fe as _};
