import{_ as ut}from"./VPagination.vuevuetypescriptsetuptruelang-CcKj-FBb.js";import{_ as rt,b as ct,u as mt,a as pt}from"./key-events-DNEDF963.js";import{d as Y,c as o,M as T,o as l,a as r,N as vt,t as i,r as F,aD as _t,ai as Ee,aj as ft,h as M,R as se,aE as yt,aF as bt,a0 as V,a1 as q,I as R,aG as De,L as he,m as ce,aH as ze,aI as Fe,aJ as Be,aK as X,v as h,j as c,an as $e,k as s,B as Re,z as Oe,x as gt,y as ht,aL as Pe,W as Ke,u as Qe,i as be,aM as Ie,af as ge,ac as ke,al as $t,aN as kt,O as K,P as Ce,H as we,A as B,Q as je,aO as qe,T as Ct,U as Se,V as Le,aP as re,e as wt,s as Vt,f as Tt,X as Nt,Y as It,g as qt,w as St,Z as Lt,$ as Ut,a2 as Mt,a5 as oe,aQ as At,G as Ue,aR as Et,J as Dt,ao as zt,K as Ft,a4 as Bt,C as Rt,a6 as Ot,ag as Pt,a7 as x,a8 as Kt,a9 as Qt,aS as jt}from"./index-CiJYwD0I.js";import{_ as Ht}from"./AllCheckedAlert.vuevuetypescriptsetuptruelang-CS7wyyr7.js";import{_ as He}from"./VCheckbox-DY9-xm2z.js";import{u as Gt,a as Wt}from"./tags-C4J8aSeC.js";import{_ as Jt}from"./ListItemPhone.vuevuetypescriptsetuptruelang-Ces94TEX.js";import{_ as Zt}from"./call-outline-rounded-BYyqpMhX.js";import{_ as Xt,S as Yt}from"./SendSmsModal-x4L545dc.js";import{_ as xt}from"./FieldId.vuevuetypescriptsetuptruelang-C8u7Jssa.js";const el={key:0,class:"contact-item selectable-card-skeleton"},tl={class:"start"},ll={class:"number"},ol=Y({__name:"ContactSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(L){return(b,_)=>{const a=rt;return b.isPhone?(l(),T(a,{key:1,"title-width":"70%",subtitles:[{width:"45%"},{width:"30%"},{width:"40%"}],"action-count":3})):(l(),o("section",el,[r("div",tl,[_[0]||(_[0]=r("div",{class:"skeleton-checkbox"},null,-1)),r("span",ll,i(b.index),1)]),_[1]||(_[1]=vt('<div class="image"><div class="skeleton-image lg"></div></div><div class="title"><div class="skeleton-text lg" style="width:50%;"></div></div><div class="subtitle"><div class="skeleton-text" style="width:40%;"></div></div><div class="info"><div class="skeleton-text" style="width:180px;"></div></div><div class="actions"><div class="skeleton-text lg" style="width:120px;"></div></div><div class="time"><div class="skeleton-text" style="width:60px;"></div></div>',6))]))}}}),nl={class:"v-select__border"},sl={key:0,class:"v-select__legend"},al={class:"v-select__content"},il={key:0,class:"v-select__text"},dl={key:1,class:"v-select__placeholder"},ul=["onClick"],rl={key:0,class:"v-select-option__check",viewBox:"0 0 24 24"},cl=Y({__name:"VSelect",props:{modelValue:{},label:{},placeholder:{},disabled:{type:Boolean},error:{type:Boolean},options:{}},emits:["update:modelValue","change"],setup(L,{emit:b}){const _=L,a=b,g=F(),A=F(),k=F(!1),E=F(!1),C=F({}),e=_t(()=>{var p;return!_.modelValue||!_.options?"":((p=_.options.find(w=>w.value===_.modelValue))==null?void 0:p.label)||""}),v=()=>{k.value=!1,E.value=!1},N=async()=>{if(!_.disabled&&(k.value=!0,E.value=!0,await De(),g.value)){const p=g.value.getBoundingClientRect();C.value={position:"fixed",top:`${p.bottom+4}px`,left:`${p.left}px`,minWidth:`${p.width}px`,maxHeight:"50vh",zIndex:9999}}},I=()=>{_.disabled||(k.value?v():N())},D=p=>{p.disabled||(a("update:modelValue",p.value),a("change",p.value),v())},Q=p=>{if(!_.disabled)switch(p.key){case"Enter":case" ":p.preventDefault(),I();break;case"Escape":k.value&&(p.preventDefault(),v());break;case"ArrowDown":case"ArrowUp":p.preventDefault(),k.value||N();break}},H=p=>{k.value&&g.value&&!g.value.contains(p.target)&&(!A.value||!A.value.contains(p.target))&&v()};return Ee(()=>{document.addEventListener("click",H)}),ft(()=>{document.removeEventListener("click",H)}),(p,w)=>(l(),o("div",{ref_key:"selectRef",ref:g,class:se(["v-select",{"v-select--disabled":p.disabled,"v-select--focused":E.value,"v-select--open":k.value,"v-select--error":p.error}]),tabindex:"0",onClick:I,onKeydown:Q},[r("fieldset",nl,[p.label?(l(),o("legend",sl,i(p.label),1)):M("",!0)]),r("div",al,[e.value?(l(),o("span",il,i(e.value),1)):p.placeholder?(l(),o("span",dl,i(p.placeholder),1)):M("",!0)]),(l(),o("svg",{class:se(["v-select__arrow",{"v-select__arrow--open":k.value}]),viewBox:"0 0 24 24"},w[0]||(w[0]=[r("path",{d:"M7 10L12 15L17 10",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)]),2)),(l(),T(yt,{to:"body"},[k.value?(l(),o("div",{key:0,ref_key:"menuRef",ref:A,class:"v-select-menu",style:bt(C.value)},[(l(!0),o(V,null,q(p.options,O=>(l(),o("div",{key:O.value,class:se(["v-select-option",{"v-select-option--selected":O.value===p.modelValue,"v-select-option--disabled":O.disabled}]),onClick:S=>D(O)},[R(i(O.label)+" ",1),O.value===p.modelValue?(l(),o("svg",rl,w[1]||(w[1]=[r("path",{d:"M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z",fill:"currentColor"},null,-1)]))):M("",!0)],10,ul))),128))],4)):M("",!0)]))],34))}}),ml=he(cl,[["__scopeId","data-v-8f00dead"]]),pl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function vl(L,b){return l(),o("svg",pl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M12 13.825L8.1 17.7q-.275.275-.687.288T6.7 17.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.213t.375-.062t.375.062t.325.213l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275zm0-6L8.1 11.7q-.275.275-.687.288T6.7 11.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.212T12 5.425t.375.063t.325.212l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275z"},null,-1)]))}const _l=ce({name:"material-symbols-keyboard-double-arrow-up-rounded",render:vl}),fl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function yl(L,b){return l(),o("svg",fl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"m12 16.175l3.9-3.875q.275-.275.688-.288t.712.288q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213l-4.6-4.6q-.275-.275-.288-.687T6.7 12.3q.275-.275.7-.275t.7.275zm0-6L15.9 6.3q.275-.275.688-.287t.712.287q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213L6.7 7.7q-.275-.275-.288-.687T6.7 6.3q.275-.275.7-.275t.7.275z"},null,-1)]))}const bl=ce({name:"material-symbols-keyboard-double-arrow-down-rounded",render:yl});function ee(L){return Array.from({length:L},(b,_)=>_+1).concat(-1)}const ne={phoneNumberTypes:ee(20),emailTypes:ee(4),addressTypes:ee(3),eventTypes:ee(3),imTypes:ee(8),websiteTypes:ee(7)},gl=Y({__name:"PromptModal",props:{do:{type:Function,required:!0},title:{type:String,required:!0},value:{type:String,default:""}},setup(L){const{handleSubmit:b}=ze(),_=F(),a=L,{value:g,resetField:A,errorMessage:k}=Fe("inputValue",Be().required()),E=b(()=>{a.do(String(g.value||"")),X()});return a.value?g.value=a.value:A(),Ee(async()=>{await De(),requestAnimationFrame(()=>{setTimeout(()=>{var C;try{document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),(C=_.value)==null||C.focus()}catch(e){console.debug("Focus blocked:",e)}},100)})}),(C,e)=>{const v=Oe,N=$e,I=Re,D=Pe;return l(),T(D,{onClose:s(X)},{headline:h(()=>[R(i(L.title),1)]),content:h(()=>[c(v,{ref_key:"inputRef",ref:_,modelValue:s(g),"onUpdate:modelValue":e[0]||(e[0]=Q=>ht(g)?g.value=Q:null),class:"form-control",error:!!s(k),"error-text":s(k)?C.$t(s(k)):"",onKeyup:gt(s(E),["enter"])},null,8,["modelValue","error","error-text","onKeyup"])]),actions:h(()=>[c(N,{value:"cancel",onClick:s(X)},{default:h(()=>[R(i(C.$t("cancel")),1)]),_:1},8,["onClick"]),c(I,{value:"ok",onClick:s(E)},{default:h(()=>[R(i(C.$t("ok")),1)]),_:1},8,["onClick"])]),_:1},8,["onClose"])}}}),hl={class:"form-label"},$l={class:"form-row"},kl={key:1,class:"v-center"},Cl={key:0,class:"form-row"},wl={class:"v-center"},Vl={class:"form-label"},Tl={class:"v-center"},Nl=["onClick"],Il={key:1,class:"form-label"},ql={class:"v-center"},Sl=["onClick"],Ll={key:2,class:"form-label"},Ul={class:"v-center"},Ml=["onClick"],Al={key:3,class:"form-label"},El={class:"v-center"},Dl=["onClick"],zl={key:4,class:"form-label"},Fl={class:"v-center"},Bl=["onClick"],Rl={class:"form-row",style:{display:"block",position:"relative"}},Ol={class:"form-row"},Me=Y({__name:"EditContactModal",props:{data:{type:Object,default:()=>({})},sources:{type:Array,default:()=>[]},done:{type:Function,default:()=>{}}},setup(L){const{handleSubmit:b}=ze(),_=L,a=Ke({firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",nickname:"",organization:null,notes:"",source:"",starred:0,phoneNumbers:[],emails:[],addresses:[],websites:[],events:[],ims:[],groupIds:[]}),g=F(!1),A=F(!1),{t:k}=Qe(),{mutate:E,loading:C,onDone:e}=be({document:ge`
    mutation createContact($input: ContactInput!) {
      createContact(input: $input) {
        ...ContactFragment
      }
    }
    ${Ie}
  `,options:{update:()=>{_.done()}}}),{mutate:v,loading:N,onDone:I}=be({document:ge`
    mutation updateContact($id: ID!, $input: ContactInput!) {
      updateContact(id: $id, input: $input) {
        ...ContactFragment
      }
    }
    ${Ie}
  `,options:{update:()=>{_.done()}}}),{value:D,resetField:Q,errorMessage:H}=Fe("inputValue",Be().test("required",n=>"valid.required",n=>!0).test("target-value",n=>"invalid_value",n=>!0)),p=(n,m)=>{n.splice(0,n.length);for(const y of m)n.push({label:y.label,value:y.value,type:y.type})};(()=>{const n=_.data;n?(Object.assign(a,{firstName:n.firstName,middleName:n.middleName,lastName:n.lastName,prefix:n.prefix,suffix:n.suffix,notes:n.notes}),p(a.phoneNumbers,n.phoneNumbers),p(a.emails,n.emails),p(a.addresses,n.addresses),p(a.websites,n.websites),p(a.events,n.events),p(a.ims,n.ims)):(Object.assign(a,{firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",notes:"",phoneNumbers:[{type:2,value:"",label:""}],emails:[],addresses:[],websites:[],events:[],ims:[]}),Q())})();const w=n=>{n.type===-1&&kt(gl,{value:n.label,title:k("custom"),do:m=>{n.label=m}})},O=(n,m,y)=>m===-1?n.label?n.label:k("custom"):k(`contact.${y}.${m}`),S=(n,m,y)=>n.map(G=>({value:G,label:O(y,G,m)})),t=n=>{n.push({type:1,value:"",label:""}),A.value=!1},z=(n,m)=>{n.splice(m,1)},j=b(()=>{var n,m;_.data?v({id:_.data.id,input:a}):(a.source=((m=(n=_.sources)==null?void 0:n[0])==null?void 0:m.name)??"",E({input:a}))});return e(()=>{X()}),I(()=>{X()}),(n,m)=>{const y=Oe,G=bl,me=_l,W=ml,J=ke,ae=$e,pe=$t,ie=Re,de=Pe;return l(),T(de,{onClose:s(X)},{headline:h(()=>[R(i(L.data?n.$t("edit"):n.$t("create")),1)]),content:h(()=>[r("label",hl,i(n.$t("name")),1),r("div",$l,[c(y,{modelValue:a.firstName,"onUpdate:modelValue":m[0]||(m[0]=d=>a.firstName=d),label:n.$t("first_name")},null,8,["modelValue","label"]),g.value?(l(),T(y,{key:0,modelValue:a.middleName,"onUpdate:modelValue":m[1]||(m[1]=d=>a.middleName=d),label:n.$t("middle_name")},null,8,["modelValue","label"])):M("",!0),c(y,{modelValue:a.lastName,"onUpdate:modelValue":m[2]||(m[2]=d=>a.lastName=d),label:n.$t("last_name")},null,8,["modelValue","label"]),g.value?M("",!0):(l(),o("div",kl,[r("button",{class:"btn-icon",onClick:m[3]||(m[3]=d=>g.value=!0)},[c(G)])]))]),g.value?(l(),o("div",Cl,[c(y,{modelValue:a.prefix,"onUpdate:modelValue":m[4]||(m[4]=d=>a.prefix=d),label:n.$t("prefix")},null,8,["modelValue","label"]),c(y,{modelValue:a.suffix,"onUpdate:modelValue":m[5]||(m[5]=d=>a.suffix=d),label:n.$t("suffix")},null,8,["modelValue","label"]),r("div",wl,[r("button",{class:"btn-icon",onClick:m[6]||(m[6]=d=>g.value=!1)},[c(me)])])])):M("",!0),r("label",Vl,i(n.$t("phone_number")),1),(l(!0),o(V,null,q(a.phoneNumbers,(d,U)=>(l(),o("div",{key:U,class:"form-row"},[c(W,{modelValue:d.type,"onUpdate:modelValue":f=>d.type=f,modelModifiers:{number:!0},class:"flex-2",options:S(s(ne).phoneNumberTypes,"phone_number_type",d),onChange:f=>w(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":f=>d.value=f,placeholder:n.$t("telephone"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",Tl,[a.phoneNumbers.length>1?(l(),o("button",{key:0,class:"btn-icon",onClick:f=>z(a.phoneNumbers,U)},[c(J)],8,Nl)):M("",!0)])]))),128)),a.emails.length?(l(),o("label",Il,i(n.$t("email")),1)):M("",!0),(l(!0),o(V,null,q(a.emails,(d,U)=>(l(),o("div",{key:U,class:"form-row"},[c(W,{modelValue:d.type,"onUpdate:modelValue":f=>d.type=f,modelModifiers:{number:!0},class:"flex-2",options:S(s(ne).emailTypes,"email_type",d),onChange:f=>w(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":f=>d.value=f,label:n.$t("email"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),r("div",ql,[r("button",{class:"btn-icon",onClick:f=>z(a.emails,U)},[c(J)],8,Sl)])]))),128)),a.addresses.length?(l(),o("label",Ll,i(n.$t("address")),1)):M("",!0),(l(!0),o(V,null,q(a.addresses,(d,U)=>(l(),o("div",{key:U,class:"form-row"},[c(W,{modelValue:d.type,"onUpdate:modelValue":f=>d.type=f,modelModifiers:{number:!0},class:"flex-2",options:S(s(ne).addressTypes,"address_type",d),onChange:f=>w(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":f=>d.value=f,label:n.$t("address"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),r("div",Ul,[r("button",{class:"btn-icon",onClick:f=>z(a.addresses,U)},[c(J)],8,Ml)])]))),128)),a.websites.length?(l(),o("label",Al,i(n.$t("website")),1)):M("",!0),(l(!0),o(V,null,q(a.websites,(d,U)=>(l(),o("div",{key:U,class:"form-row"},[c(W,{modelValue:d.type,"onUpdate:modelValue":f=>d.type=f,modelModifiers:{number:!0},class:"flex-2",options:S(s(ne).websiteTypes,"website_type",d),onChange:f=>w(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":f=>d.value=f,placeholder:n.$t("website"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",El,[r("button",{class:"btn-icon",onClick:f=>z(a.websites,U)},[c(J)],8,Dl)])]))),128)),a.ims.length?(l(),o("label",zl,i(n.$t("im")),1)):M("",!0),(l(!0),o(V,null,q(a.ims,(d,U)=>(l(),o("div",{key:U,class:"form-row"},[c(W,{modelValue:d.type,"onUpdate:modelValue":f=>d.type=f,modelModifiers:{number:!0},class:"flex-2",options:S(s(ne).imTypes,"im_type",d),onChange:f=>w(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),c(y,{modelValue:d.value,"onUpdate:modelValue":f=>d.value=f,placeholder:n.$t("im"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),r("div",Fl,[r("button",{class:"btn-icon",onClick:f=>z(a.ims,U)},[c(J)],8,Bl)])]))),128)),r("div",Rl,[c(pe,{modelValue:A.value,"onUpdate:modelValue":m[12]||(m[12]=d=>A.value=d),placement:"auto",align:"top-left-to-bottom-left"},{trigger:h(()=>[c(ae,null,{default:h(()=>[R(i(n.$t("add_field")),1)]),_:1})]),default:h(()=>[r("div",{class:"dropdown-item",onClick:m[7]||(m[7]=()=>t(a.phoneNumbers))},i(n.$t("phone_number")),1),r("div",{class:"dropdown-item",onClick:m[8]||(m[8]=()=>t(a.emails))},i(n.$t("email")),1),r("div",{class:"dropdown-item",onClick:m[9]||(m[9]=()=>t(a.addresses))},i(n.$t("address")),1),r("div",{class:"dropdown-item",onClick:m[10]||(m[10]=()=>t(a.websites))},i(n.$t("website")),1),r("div",{class:"dropdown-item",onClick:m[11]||(m[11]=()=>t(a.ims))},i(n.$t("im")),1)]),_:1},8,["modelValue"])]),r("div",Ol,[c(y,{modelValue:a.notes,"onUpdate:modelValue":m[13]||(m[13]=d=>a.notes=d),type:"textarea",label:n.$t("notes"),rows:3},null,8,["modelValue","label"])])]),actions:h(()=>[c(ae,{value:"cancel",onClick:s(X)},{default:h(()=>[R(i(n.$t("cancel")),1)]),_:1},8,["onClick"]),c(ie,{value:"save",loading:s(C)||s(N),onClick:s(j)},{default:h(()=>[R(i(n.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),Pl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Kl(L,b){return l(),o("svg",Pl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M12 14q.825 0 1.413-.587T14 12t-.587-1.412T12 10t-1.412.588T10 12t.588 1.413T12 14m-4 4h8v-.575q0-.6-.325-1.1t-.9-.75q-.65-.275-1.338-.425T12 15t-1.437.15t-1.338.425q-.575.25-.9.75T8 17.425zm10 4H6q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V20q0 .825-.587 1.413T18 22m0-2V8.85L13.15 4H6v16zM6 20V4z"},null,-1)]))}const Ql=ce({name:"material-symbols-contact-page-outline-rounded",render:Kl}),jl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Hl(L,b){return l(),o("svg",jl,b[0]||(b[0]=[r("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)]))}const Gl=ce({name:"material-symbols-edit",render:Hl}),Wl={class:"actions"},Ae=Y({__name:"ContactActionButtons",props:{item:{}},emits:["deleteItem","edit","addItemToTags"],setup(L,{emit:b}){const _=L,a=b;function g(){a("deleteItem",_.item)}function A(){a("edit",_.item)}function k(){a("addItemToTags",_.item)}return(E,C)=>{const e=ke,v=we,N=Gl,I=je,D=Ce("tooltip");return l(),o("div",Wl,[K((l(),T(v,{onClick:B(g,["stop"])},{default:h(()=>[c(e)]),_:1})),[[D,E.$t("delete")]]),K((l(),T(v,{onClick:B(A,["stop"])},{default:h(()=>[c(N)]),_:1})),[[D,E.$t("edit")]]),K((l(),T(v,{onClick:B(k,["stop"])},{default:h(()=>[c(I)]),_:1})),[[D,E.$t("add_to_tags")]])])}}}),Jl={class:"start"},Zl={class:"number"},Xl=["src"],Yl={class:"title"},xl={class:"subtitle"},eo={key:0},to={class:"info"},lo={class:"list-unstyled"},oo={class:"time"},no=["src"],so={class:"subtitle"},ao={key:0},io={class:"info"},uo={class:"list-unstyled"},ro={class:"time"},co=Y({__name:"ContactListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},dataType:{},callLoading:{type:Boolean},callId:{},callIndex:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function}},emits:["deleteItem","edit","addItemToTags","sendSms","call"],setup(L,{emit:b}){const _=b;function a(e){_("deleteItem",e)}function g(e){_("edit",e)}function A(e){_("addItemToTags",e)}function k(e,v,N){_("call",e,v,N)}function E(e,v,N){_("sendSms",e,v,N)}function C(e){let v="";re(e.firstName)||re(e.lastName)?v=`${e.lastName}${e.middleName}${e.firstName}`:v=[e.firstName,e.middleName,e.lastName].filter(D=>D).join(" ");const N=e.suffix?`, ${e.suffix}`:"",I=`${e.prefix} ${v} ${N}`.trim();return I||(e.emails.length?e.emails[0].value:"")}return(e,v)=>{const N=He,I=xt,D=Ql,Q=Ct,H=Xt,p=we,w=Zt,O=Jt,S=Ce("tooltip");return e.isPhone?(l(),T(O,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:v[4]||(v[4]=t=>e.handleItemClick(t,e.item,e.index,()=>{})),onMouseenter:v[5]||(v[5]=B(t=>e.handleMouseOver(t,e.index),["stop"])),onCheckboxClick:v[6]||(v[6]=t=>e.toggleSelect(t,e.item,e.index))},{image:h(()=>[e.item.thumbnailId?(l(),o("img",{key:0,class:"image",src:s(qe)(e.item.thumbnailId),width:"50"},null,8,no)):(l(),T(D,{key:1,class:"image"}))]),title:h(()=>[R(i(C(e.item)),1)]),subtitle:h(()=>[r("div",so,[e.item.notes?(l(),o("span",ao,i(e.item.notes),1)):M("",!0),c(Q,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),r("div",io,[r("ul",uo,[(l(!0),o(V,null,q(e.item.phoneNumbers,(t,z)=>(l(),o("li",{key:z,class:"phone-number"},[R(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),K((l(),T(p,{onClick:B(j=>E(e.item.id,t.normalizedNumber||t.value,z),["stop"])},{default:h(()=>[c(H)]),_:2},1032,["onClick"])),[[S,e.$t("send_sms")]]),K((l(),T(p,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===z,onClick:B(j=>k(e.item.id,t.normalizedNumber||t.value,z),["stop"])},{default:h(()=>[c(w)]),_:2},1032,["loading","onClick"])),[[S,e.$t("make_a_phone_call")]])]))),128)),(l(!0),o(V,null,q(e.item.emails,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.addresses,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.websites,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.ims,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.events,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),r("div",ro,[K((l(),o("span",null,[R(i(s(Le)(e.item.updatedAt)),1)])),[[S,s(Se)(e.item.updatedAt)]])])]),actions:h(()=>[c(Ae,{item:e.item,onDeleteItem:a,onEdit:g,onAddItemToTags:A},null,8,["item"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(l(),o("section",{key:0,class:se(["contact-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:v[2]||(v[2]=B(t=>e.handleItemClick(t,e.item,e.index,()=>{}),["stop"])),onMouseenter:v[3]||(v[3]=B(t=>e.handleMouseOver(t,e.index),["stop"]))},[r("div",Jl,[e.shiftEffectingIds.includes(e.item.id)?(l(),T(N,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:v[0]||(v[0]=B(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])):(l(),T(N,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:v[1]||(v[1]=B(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])),r("span",Zl,[c(I,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),e.item.thumbnailId?(l(),o("img",{key:0,class:"image",src:s(qe)(e.item.thumbnailId),width:"50"},null,8,Xl)):(l(),T(D,{key:1,class:"image"})),r("div",Yl,i(C(e.item)),1),r("div",xl,[e.item.notes?(l(),o("span",eo,i(e.item.notes),1)):M("",!0),c(Q,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),r("div",to,[r("ul",lo,[(l(!0),o(V,null,q(e.item.phoneNumbers,(t,z)=>(l(),o("li",{key:z,class:"phone-number"},[R(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),K((l(),T(p,{onClick:B(j=>E(e.item.id,t.normalizedNumber||t.value,z),["stop"])},{default:h(()=>[c(H)]),_:2},1032,["onClick"])),[[S,e.$t("send_sms")]]),K((l(),T(p,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===z,onClick:B(j=>k(e.item.id,t.normalizedNumber||t.value,z),["stop"])},{default:h(()=>[c(w)]),_:2},1032,["loading","onClick"])),[[S,e.$t("make_a_phone_call")]])]))),128)),(l(!0),o(V,null,q(e.item.emails,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.addresses,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.websites,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.ims,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),o(V,null,q(e.item.events,t=>(l(),o("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),c(Ae,{item:e.item,onDeleteItem:a,onEdit:g,onAddItemToTags:A},null,8,["item"]),r("div",oo,[K((l(),o("span",null,[R(i(s(Le)(e.item.updatedAt)),1)])),[[S,s(Se)(e.item.updatedAt)]])])],34))}}}),mo=he(co,[["__scopeId","data-v-69df6ea0"]]),po={class:"top-app-bar"},vo={class:"title"},_o={key:0},fo={key:1},yo={class:"actions"},bo={class:"scroll-content"},go={key:0,class:"no-data-placeholder"},te=50,ho=Y({__name:"ContactsView",setup(L){const b=Ft("isPhone"),_=wt(),{app:a}=Vt(Tt()),g=F([]),{t:A}=Qe(),{parseQ:k}=Qt(),E=Ke({tagIds:[]}),C=Nt.CONTACT,e=Bt(),v=F(1),N=F([]),I=F(""),{tags:D,fetch:Q}=Gt(C),{addToTags:H}=Wt(C,D),{deleteItems:p}=ct(jt,()=>{j(),f(),x.emit("refetch_tags",C)}),{selectedIds:w,allChecked:O,realAllChecked:S,selectRealAll:t,allCheckedAlertVisible:z,clearSelection:j,toggleAllChecked:n,toggleSelect:m,total:y,checked:G,shiftEffectingIds:me,handleItemClick:W,handleMouseOver:J,selectAll:ae,shouldSelect:pe}=mt(g),ie=u=>{const $=e.query.q;Rt(_,$?`/contacts?page=${u}&q=${$}`:`/contacts?page=${u}`)},{keyDown:de,keyUp:d}=pt(y,te,v,ae,j,ie,()=>{p(w.value,S.value,y.value,I.value)}),{loading:U,fetch:f}=It({handle:(u,$)=>{$?Ue(A($),"error"):u&&(g.value=u.contacts,y.value=u.contactCount)},document:At,variables:()=>({offset:(v.value-1)*te,limit:te,query:I.value})});qt({handle:(u,$)=>{$?Ue(A($),"error"):u&&(N.value=u.contactSources)},document:Et,variables:null});const Ve=u=>{u.type===C&&(j(),f())},Te=u=>{u.type===C&&f()};function Ge(u){oe(Ot,{type:C,tags:D.value,item:{key:u.id,title:"",size:0},selected:D.value.filter($=>u.tags.some(P=>P.id===$.id))})}function We(u){let $="";re(u.firstName)||re(u.lastName)?$=`${u.lastName}${u.middleName}${u.firstName}`:$=[u.firstName,u.middleName,u.lastName].filter(le=>le).join(" ");const P=u.suffix?`, ${u.suffix}`:"",ue=`${u.prefix} ${$} ${P}`.trim();return ue||(u.emails.length?u.emails[0].value:"")}function Je(u){oe(Pt,{id:u.id,name:We(u),gql:ge`
      mutation DeleteContact($query: String!) {
        deleteContacts(query: $query)
      }
    `,variables:()=>({query:`ids:${u.id}`}),typeName:"Contact",done:()=>{y.value--,u.tags.length&&x.emit("refetch_tags",C)}})}function Ze(u){oe(Me,{data:u,sources:N,done:f})}function Xe(){oe(Me,{data:null,sources:N,done:f})}const ve=F(""),_e=F(0),{mutate:Ye,loading:xe}=be({document:Dt});function et(u,$,P){ve.value=u,_e.value=P,Ye({number:$})}function tt(u,$,P){ve.value=u,_e.value=P,oe(Yt,{number:$})}const fe=F(!1);function Ne(){var $,P;const u=parseInt((($=e.query.page)==null?void 0:$.toString())??"1");v.value=Number.isFinite(u)&&u>0?u:1,I.value=Kt(((P=e.query.q)==null?void 0:P.toString())??""),k(E,I.value),f()}return St(()=>e.fullPath,()=>{fe.value&&Ne()}),Lt(()=>{Q(),fe.value=!0,Ne(),x.on("item_tags_updated",Te),x.on("items_tags_updated",Ve),window.addEventListener("keydown",de),window.addEventListener("keyup",d)}),Ut(()=>{fe.value=!1,x.off("item_tags_updated",Te),x.off("items_tags_updated",Ve),window.removeEventListener("keydown",de),window.removeEventListener("keyup",d)}),(u,$)=>{const P=He,ue=ke,le=we,lt=zt,ot=je,nt=$e,st=Ht,at=ol,it=ut,ye=Ce("tooltip");return l(),o(V,null,[r("div",po,[c(P,{"touch-target":"wrapper",checked:s(O),indeterminate:!s(O)&&s(G),onChange:s(n)},null,8,["checked","indeterminate","onChange"]),r("div",vo,[s(w).length?(l(),o("span",_o,i(u.$t("x_selected",{count:s(S)?s(y).toLocaleString():s(w).length.toLocaleString()})),1)):(l(),o("span",fo,i(u.$t("page_title.contacts"))+" ("+i(s(y).toLocaleString())+")",1)),s(G)?(l(),o(V,{key:2},[K((l(),T(le,{onClick:$[0]||($[0]=B(Z=>s(p)(s(w),s(S),s(y),I.value),["stop"]))},{default:h(()=>[c(ue)]),_:1})),[[ye,u.$t("delete")]]),K((l(),T(le,{style:{display:"none"}},{default:h(()=>[c(lt)]),_:1})),[[ye,u.$t("download")]]),K((l(),T(le,{onClick:$[1]||($[1]=B(Z=>s(H)(s(w),s(S),I.value),["stop"]))},{default:h(()=>[c(ot)]),_:1})),[[ye,u.$t("add_to_tags")]])],64)):M("",!0)]),r("div",yo,[c(nt,{class:"btn-sm",onClick:Xe},{default:h(()=>[R(i(u.$t("create")),1)]),_:1})])]),c(st,{limit:te,total:s(y),"all-checked-alert-visible":s(z),"real-all-checked":s(S),"select-real-all":s(t),"clear-selection":s(j)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),r("div",bo,[r("div",{class:se(["main-list",{"select-mode":s(G)}])},[(l(!0),o(V,null,q(g.value,(Z,dt)=>(l(),T(mo,{key:Z.id,item:Z,index:dt,"selected-ids":s(w),"shift-effecting-ids":s(me),"should-select":s(pe),"is-phone":s(b),"data-type":s(C),"call-loading":s(xe),"call-id":ve.value,"call-index":_e.value,"handle-item-click":s(W),"handle-mouse-over":s(J),"toggle-select":s(m),onDeleteItem:Je,onEdit:Ze,onAddItemToTags:Ge,onSendSms:tt,onCall:et},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","data-type","call-loading","call-id","call-index","handle-item-click","handle-mouse-over","toggle-select"]))),128)),s(U)&&g.value.length===0?(l(),o(V,{key:0},q(20,Z=>c(at,{key:Z,index:Z,"is-phone":s(b)},null,8,["index","is-phone"])),64)):M("",!0)],2),!s(U)&&g.value.length===0?(l(),o("div",go,i(u.$t(s(Mt)(s(U),s(a).permissions,"WRITE_CONTACTS"))),1)):M("",!0),s(y)>te?(l(),T(it,{key:1,page:v.value,go:ie,total:s(y),limit:te},null,8,["page","total"])):M("",!0)])],64)}}}),Lo=he(ho,[["__scopeId","data-v-e0575a7c"]]);export{Lo as default};
