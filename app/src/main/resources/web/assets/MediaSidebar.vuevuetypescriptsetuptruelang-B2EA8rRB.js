import{_ as te}from"./LeftSidebar.vuevuetypescriptsetuptruelang-BDdMylOV.js";import{_ as se}from"./TagFilter.vuevuetypescriptsetuptruelang-KR6lKuRu.js";import{m as U,c as p,o,a as n,d as G,u as ae,e as N,r as q,X as A,bf as oe,g as ne,bA as le,G as ie,aA as H,ad as S,aB as z,$ as O,I as re,t as h,a1 as P,O as k,H as j,A as w,v as V,bB as ce,aK as ue,W as R,U as _e,T as x,k as b,f as F,s as de,M as pe,ae as i,N as me,w as ve,P as L,Q as he,R as fe,j as T,h as M,b5 as ye,b6 as ge,D as Te,C as Q,E as qe}from"./index-9yvO6RpE.js";import{_ as ke}from"./trash-B61pKMNv.js";import{_ as be}from"./layout-grid-BgBqmbBg.js";const $e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ie(m,e){return o(),p("svg",$e,e[0]||(e[0]=[n("path",{fill:"currentColor",d:"m12 10.775l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.213T12 8.4t.375.063t.325.212l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"},null,-1)]))}const Ce=U({name:"material-symbols-expand-less-rounded",render:Ie}),Be={class:"section-title"},Ae={class:"nav"},Se=["onClick"],we={class:"title"},De={class:"count"},Ee=G({__name:"BucketFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(m){const e=m,{t:$}=ae(),s=N(),I=q([]),f=A(()=>{var a;return!!((a=s.bucketFilterCollapsed)!=null&&a[e.type])});function v(){s.bucketFilterCollapsed[e.type]=!f.value}const g=A(()=>[...I.value??[]].sort((a,u)=>(a.name??"").localeCompare(u.name??"",void 0,{numeric:!0,sensitivity:"base"}))),{view:y}=oe(e.type),{refetch:r}=ne({handle:(a,u)=>{u?ie($(u),"error"):a&&(I.value=a.mediaBuckets)},document:le,variables:{type:e.type}}),c=a=>{a.type===e.type&&r()};return H(()=>{S.on("media_items_actioned",c)}),z(()=>{S.off("media_items_actioned",c)}),(a,u)=>{const C=ce,B=Ce,D=j,E=P("tooltip");return o(),p(R,null,[n("div",Be,[re(h(a.$t("folders"))+" ",1),O((o(),k(D,{onClick:w(v,["prevent"])},{default:V(()=>[f.value?(o(),k(C,{key:0})):(o(),k(B,{key:1}))]),_:1})),[[E,f.value?a.$t("expand_all"):a.$t("collapse_all")]])]),O(n("ul",Ae,[(o(!0),p(R,null,_e(g.value,_=>(o(),p("li",{key:_.id,class:x({active:m.selected&&_.id===m.selected}),onClick:w(t=>b(y)(b(s),_.id),["prevent"])},[n("span",we,h(_.name),1),n("span",De,h(_.itemCount.toLocaleString()),1)],10,Se))),128))],512),[[ue,!f.value]])],64)}}}),Me={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Oe(m,e){return o(),p("svg",Me,e[0]||(e[0]=[n("path",{fill:"currentColor",d:"M11.95 18q.525 0 .888-.363t.362-.887t-.362-.888t-.888-.362t-.887.363t-.363.887t.363.888t.887.362m.05 4q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m.1-12.3q.625 0 1.088.4t.462 1q0 .55-.337.975t-.763.8q-.575.5-1.012 1.1t-.438 1.35q0 .35.263.588t.612.237q.375 0 .638-.25t.337-.625q.1-.525.45-.937t.75-.788q.575-.55.988-1.2t.412-1.45q0-1.275-1.037-2.087T12.1 6q-.95 0-1.812.4T8.975 7.625q-.175.3-.112.638t.337.512q.35.2.725.125t.625-.425q.275-.375.688-.575t.862-.2"},null,-1)]))}const Ve=U({name:"material-symbols-help-outline-rounded",render:Oe}),xe={class:"nav"},Re={class:"icon","aria-hidden":"true"},Fe={class:"title"},Le={key:0,class:"count"},Qe={class:"icon","aria-hidden":"true"},Ue={class:"title"},Ge={key:0,class:"count"},Ke=G({__name:"MediaSidebar",props:{type:{type:String,required:!0},gql:{type:Object,required:!0}},setup(m){F();const e=m,$=N(),{counter:s,app:I}=de(F()),{parseQ:f}=fe(),v=pe({tagIds:[]}),g=q(""),y=q(!1),r=q(""),c=q(""),a=A(()=>{var t,d,l;return e.type===i.IMAGE?((t=s.value)==null?void 0:t.images)??-1:e.type===i.VIDEO?((d=s.value)==null?void 0:d.videos)??-1:e.type===i.AUDIO?((l=s.value)==null?void 0:l.audios)??-1:-1}),u=A(()=>{var t,d,l;return e.type===i.IMAGE?((t=s.value)==null?void 0:t.imagesTrash)??-1:e.type===i.VIDEO?((d=s.value)==null?void 0:d.videosTrash)??-1:e.type===i.AUDIO?((l=s.value)==null?void 0:l.audiosTrash)??-1:-1}),{fetch:C}=me({handle:t=>{t&&(e.type===i.IMAGE?(s.value.images=t.total,s.value.imagesTrash=t.trash):e.type===i.VIDEO?(s.value.videos=t.total,s.value.videosTrash=t.trash):e.type===i.AUDIO&&(s.value.audios=t.total,s.value.audiosTrash=t.trash))},document:e.gql,variables:()=>({})});function B(){var l;const t=L.currentRoute.value;g.value=t.meta.group||"",C();const d=he(((l=t.query.q)==null?void 0:l.toString())??"");f(v,d),r.value=v.tagIds.length===1?v.tagIds[0]:"",y.value=v.trash??!1,c.value=v.bucketId??"",r.value&&c.value&&(r.value=""),y.value&&(c.value="",r.value="")}B(),ve(()=>L.currentRoute.value.fullPath,()=>{B()});function D(){const t=Te([{name:"trash",op:"",value:"true"}]);Q($,`/${g.value}?q=${qe(t)}`)}function E(){Q($,`/${g.value}`)}const _=t=>{t.type===e.type&&C()};return H(()=>{S.on("media_items_actioned",_)}),z(()=>{S.off("media_items_actioned",_)}),(t,d)=>{const l=be,K=ke,W=Ve,X=j,J=Ee,Y=se,Z=te,ee=P("tooltip");return o(),k(Z,null,{body:V(()=>[n("ul",xe,[n("li",{class:x({active:!r.value&&!c.value&&!y.value}),onClick:w(E,["prevent"])},[n("span",Re,[T(l)]),n("span",Fe,h(t.$t("all")),1),a.value>=0?(o(),p("span",Le,h(a.value.toLocaleString()),1)):M("",!0)],2),b(ye)(b(ge).MEDIA_TRASH,b(I).osVersion)?(o(),p("li",{key:0,class:x({active:y.value}),onClick:w(D,["prevent"])},[n("span",Qe,[T(K)]),n("span",Ue,h(t.$t("trash")),1),O((o(),k(X,{class:"btn-help sm"},{default:V(()=>[T(W)]),_:1})),[[ee,t.$t("trash_tips")]]),u.value>=0?(o(),p("span",Ge,h(u.value.toLocaleString()),1)):M("",!0)],2)):M("",!0)]),T(J,{type:e.type,selected:c.value},null,8,["type","selected"]),T(Y,{type:e.type,selected:r.value},null,8,["type","selected"])]),_:1})}}});export{Ke as _};
