import{d as N,aH as j,r as h,aI as z,cF as H,i as k,cG as R,cH as E,M as b,o as m,v as r,j as v,I as f,t as i,k as o,aK as y,an as J,B as K,a as p,O,R as C,c as Y,a1 as P,cI as U,a0 as W,cJ as X,au as Z,aL as x,a7 as q,b_ as ee,L as ae,u as $,Y as te,bq as se,G as I,a5 as oe}from"./index-DZRXRZ01.js";const ne={class:"button-group"},le=N({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=j(),t=h("add_to_tags"),a=d,{value:s,errorMessage:n}=z("selectedTags",H().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:L}=k({document:R}),{mutate:M,loading:A,onDone:F}=k({document:E}),T=()=>{q.emit("items_tags_updated",{type:a.type}),q.emit("refetch_tags",a.type),y()};F(T),L(T);function S(e){s.value.includes(e)?ee(s.value,u=>u.id===e.id):s.value.push(e)}const B=_(()=>{t.value==="add_to_tags"?M({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):l({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,u)=>{const D=U,G=X,Q=J,V=K,w=x;return m(),b(w,{onClose:o(y)},{headline:r(()=>[f(i(e.$t("tags")),1)]),content:r(()=>[p("div",ne,[p("button",{class:C({selected:t.value==="add_to_tags"}),onClick:u[0]||(u[0]=c=>t.value="add_to_tags")},i(e.$t("add_to_tags")),3),p("button",{class:C({selected:t.value==="remove_from_tags"}),onClick:u[1]||(u[1]=c=>t.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),v(G,null,{default:r(()=>[(m(!0),Y(W,null,P(d.tags,c=>(m(),b(D,{key:c.id,label:c.name,selected:o(s).includes(c),onClick:ue=>S(c)},null,8,["label","selected","onClick"]))),128))]),_:1}),O(p("div",{class:"invalid-feedback"},i(o(n)?e.$t(o(n)):""),513),[[Z,o(n)]])]),actions:r(()=>[v(Q,{value:"cancel",onClick:o(y)},{default:r(()=>[f(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),v(V,{value:"save",loading:o(A)||o(g),onClick:o(B)},{default:r(()=>[f(i(e.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),de=ae(le,[["__scopeId","data-v-8725492b"]]),re=(d,_)=>{const{t}=$();return{addToTags:(a,s,n)=>{let l=n;if(!s){if(a.length===0){I(t("select_first"),"error");return}l=`ids:${a.join(",")}`}oe(de,{type:d,tags:_.value,query:l})}}},ie=(d,_=()=>{})=>{const t=h([]),{t:a}=$(),{loading:s,fetch:n}=te({handle:async(l,g)=>{g?I(a(g),"error"):l&&(t.value=l.tags,_())},document:se,variables:{type:d}});return{tags:t,loading:s,fetch:n}};export{re as a,ie as u};
