import{m as j,c as _,o as n,a as u,d as K,u as X,W as M,a0 as Z,j as w,a8 as le,V as z,U as E,O as y,Z as I,h as F,bq as ae,k as $,H as J,A as B,v as m,ah as ue,t as v,a4 as x,T as G,aH as ee,q as te,L as Y,r as L,g as ce,br as de,G as oe,N as pe,bs as me,w as _e,aC as ve,I as Q,B as ie,aT as se,b1 as fe,bt as ge,aS as re,bu as he,be as ye,bv as ke,$ as be,a7 as Te}from"./index-Cz0mFrQo.js";import{_ as $e}from"./check-rounded-DoM5Dg_9.js";import{_ as we}from"./VolumeCard.vuevuetypescriptsetuptruelang-2o7Tc-P5.js";import{_ as Ve}from"./upload-rounded-BCdFqa_L.js";const Me={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ce(r,s){return n(),_("svg",Me,s[0]||(s[0]=[u("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h5.175q.4 0 .763.15t.637.425L12 6h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20z"},null,-1)]))}const Se=j({name:"material-symbols-folder-rounded",render:Ce}),qe={class:"browser-sidebar"},Pe={key:0,class:"volumes-loading"},Be={key:1,class:"browser-volumes"},Ue={class:"browser-main"},De={class:"toolbar"},ze={class:"path"},Ie={class:"loading-overlay","aria-live":"polite","aria-busy":"true"},Ne={class:"loading-row"},Re=["onClick"],Ae={class:"dir-icon"},Fe={class:"dir-name"},He=K({__name:"DirectoryBrowser",props:{volumes:{},loadingMounts:{type:Boolean},activeRoot:{},currentDir:{},canGoUp:{type:Boolean},listing:{type:Boolean},dirItems:{},dirName:{type:Function},browserMinHeightPx:{},listMinHeightPx:{}},emits:["selectRoot","goUp","enterDir"],setup(r,{emit:s}){const{t:l}=X(),c=r,a=s;function d(e){return e.driveType==="INTERNAL_STORAGE"?0:e.driveType==="SDCARD"?1:e.driveType==="USB_STORAGE"?2:e.driveType==="APP"?3:9}const g=M(()=>[...c.volumes].sort((e,t)=>{const k=d(e),V=d(t);return k!==V?k-V:(e.mountPoint||"").localeCompare(t.mountPoint||"")})),p=M(()=>{const e=c.volumes.filter(t=>t.driveType==="USB_STORAGE").map(t=>t.mountPoint).filter(Boolean);return new Map(e.map((t,k)=>[t,k+1]))});function f(e){if(e.driveType==="INTERNAL_STORAGE")return l("internal_storage");if(e.driveType==="APP")return l("app_data");if(e.driveType==="SDCARD")return l("sdcard");if(e.driveType==="USB_STORAGE"){const t=p.value.get(e.mountPoint)??1;return`${l("usb_storage")} ${t}`}return e.name||e.mountPoint}function C(e){const t=Number(e.totalBytes||0),k=Number(e.usedBytes||0);if(!t)return 0;const V=k/t*100;return Number.isFinite(V)?Math.max(0,Math.min(100,V)):0}function S(e){const t=Number(e.freeBytes||0),k=Number(e.totalBytes||0);return k?l("storage_free_total",{free:te(t),total:te(k)}):""}const P=M(()=>{const e=Number(c.browserMinHeightPx??260);return e?{minHeight:`${e}px`}:void 0}),H=M(()=>{const e=Number(c.listMinHeightPx??160);return e?{minHeight:`${e}px`}:void 0});return(e,t)=>{const k=le,V=ue,N=J,R=Se,U=Z("tooltip");return n(),_("div",{class:"browser",style:x(P.value)},[u("aside",qe,[e.loadingMounts?(n(),_("div",Pe,[w(k,{indeterminate:"",class:"sm"})])):(n(),_("div",Be,[(n(!0),_(z,null,E(g.value,o=>(n(),y(we,{key:o.id,title:f(o),"used-percent":C(o),count:S(o),"show-progress":Number(o.totalBytes||0)>0,data:o,active:String(o.mountPoint||"")===e.activeRoot,onClick:O=>a("selectRoot",o.mountPoint||"/")},null,8,["title","used-percent","count","show-progress","data","active","onClick"]))),128))]))]),u("section",Ue,[u("div",De,[e.canGoUp?I((n(),y(N,{key:0,onClick:t[0]||(t[0]=B(o=>a("goUp"),["stop"]))},{default:m(()=>[w(V)]),_:1})),[[U,$(l)("back")]]):F("",!0),u("div",ze,v(e.currentDir),1),ae(e.$slots,"toolbar-actions",{},void 0,!0)]),u("div",{class:G(["list",{loading:e.listing}]),style:x(H.value)},[I(u("div",Ie,[u("div",Ne,[w(k,{indeterminate:"",class:"sm"}),u("span",null,v($(l)("loading")),1)])],512),[[ee,e.listing]]),I(u("div",{class:"empty-row"},v($(l)("no_data")),513),[[ee,!e.listing&&e.dirItems.length===0]]),(n(!0),_(z,null,E(e.dirItems,o=>(n(),_("button",{key:o,class:"dir-row",onClick:O=>a("enterDir",o)},[u("span",Ae,[w(R)]),u("span",Fe,v(e.dirName(o)),1)],8,Re))),128))],6)])],4)}}}),Ee=Y(He,[["__scopeId","data-v-3ea1f89e"]]),Ge={class:"picker"},Ke={key:0,class:"picker-desc"},Oe={class:"hint"},Le={class:"picker-current__label"},Qe={class:"mono picker-current__value"},We=K({__name:"DirectoryPickerModal",props:{title:{type:String,default:""},description:{type:String,default:""},initialPath:{type:String,default:""}},setup(r,{emit:s}){const{t:l}=X(),c=r,a=s,d=L([]),g=L(!0),p=L(""),f=L(""),C=L([]),S=M(()=>{const i=String(c.initialPath||"").trim();return i?i.replace(/\/+$/g,"")||"/":""}),P=M(()=>{const i=p.value||"/",h=(f.value||"").replace(/^\/+/,"");return h?i==="/"?`/${h}`.replace(/\/+/g,"/").replace(/\/+$/g,""):`${i}/${h}`.replace(/\/+/g,"/").replace(/\/+$/g,""):i}),H=M(()=>!!p.value&&(f.value||"").trim()!=="");function e(i){p.value=i||"/",f.value=""}function t(i){const h=p.value||"";return h?h==="/"?i.replace(/^\/+/,""):i.startsWith(h)?i.slice(h.length).replace(/^\/+/,""):"":""}function k(i){f.value=t(i)}function V(){const i=(f.value||"").replace(/\/+$/g,""),h=i.lastIndexOf("/");h<=0?f.value="":f.value=i.slice(0,h)}function N(i){return fe(i)||i}function R(){a(ge.EVENT_PROMPT,P.value)}function U(){re()}ce({document:de,handle:(i,h)=>{var D;if(g.value=!1,h){oe(l(h),"error");return}d.value=[...(i==null?void 0:i.mounts)??[]].sort((A,T)=>{const b=String((A==null?void 0:A.mountPoint)??""),W=String((T==null?void 0:T.mountPoint)??"");return b==="/"?-1:W==="/"?1:b.localeCompare(W,void 0,{numeric:!0})}),p.value||(p.value=((D=d.value[0])==null?void 0:D.mountPoint)||"/",f.value="");const q=S.value;if(q){const A=d.value.map(b=>String(b.mountPoint||"").trim()).filter(b=>!!b);let T="";for(const b of A){if(b==="/"&&q.startsWith("/")){T.length<1&&(T="/");continue}b!=="/"&&(q===b||q.startsWith(b+"/"))&&b.length>T.length&&(T=b)}T&&(p.value=T,T==="/"?f.value=q.replace(/^\/+/,""):f.value=q.slice(T.length).replace(/^\/+/,""))}}});const{loading:o,fetch:O}=pe({document:me,variables:()=>({root:P.value,offset:0,limit:1e4,query:"",sortBy:"NAME_ASC"}),handle:(i,h)=>{if(h){C.value=[],oe(l(h),"error");return}const q=(i==null?void 0:i.files)??[];C.value=q.filter(D=>D.isDir).map(D=>D.path)}});return _e([p,f],()=>{p.value&&O()},{immediate:!0}),(i,h)=>{const q=$e,D=J,A=ve,T=ie,b=se,W=Z("tooltip");return n(),y(b,{onClose:U},{headline:m(()=>[Q(v(r.title||i.$t("select_folder")),1)]),content:m(()=>[u("div",Ge,[r.description?(n(),_("p",Ke,v(r.description),1)):F("",!0),u("div",Oe,[u("span",Le,v(i.$t("current_path"))+":",1),u("span",Qe,v(P.value||"-"),1)]),w(Ee,{volumes:d.value,"loading-mounts":g.value,"active-root":p.value,"current-dir":P.value,"can-go-up":H.value,listing:$(o),"dir-items":C.value,"dir-name":N,"browser-min-height-px":320,"list-min-height-px":220,onSelectRoot:e,onGoUp:V,onEnterDir:k},{"toolbar-actions":m(()=>[I((n(),y(D,{onClick:B(R,["stop"])},{default:m(()=>[w(q)]),_:1})),[[W,i.$t("ok")]])]),_:1},8,["volumes","loading-mounts","active-root","current-dir","can-go-up","listing","dir-items"])])]),actions:m(()=>[w(A,{value:"cancel",onClick:U},{default:m(()=>[Q(v(i.$t("cancel")),1)]),_:1}),w(T,{value:"ok",onClick:R},{default:m(()=>[Q(v(i.$t("ok")),1)]),_:1})]),_:1})}}}),je=Y(We,[["__scopeId","data-v-deb4898a"]]);async function Ze(r){const s=String(r.storageKey||"").trim(),l=s?String(localStorage.getItem(s)||"").trim():"",c=await he(je,{title:r.title,description:r.description,initialPath:l||r.initialPath,modalId:r.modalId||"directory-picker"});if(typeof c!="string")return;const a=c.trim();if(a)return s&&localStorage.setItem(s,a),a}function gt(r){const s=()=>{var g;const c=r.filter.bucketId;if(!c)return"";const a=r.buckets.value.find(p=>p.id===c),d=(g=a==null?void 0:a.topItems)==null?void 0:g[0];return d?ye(d):""};return{getSelectedBucketDir:s,resolveTargetDir:async()=>{const c=s();return c||Ze({title:r.picker.title,description:r.picker.description,initialPath:r.picker.initialPath||"",modalId:r.picker.modalId,storageKey:r.picker.storageKey})}}}const Je={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xe(r,s){return n(),_("svg",Je,s[0]||(s[0]=[u("path",{fill:"currentColor",d:"M5 11q-.825 0-1.412-.587T3 9V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v4q0 .825-.587 1.413T19 11zm0-2h14V5H5zm0 12q-.825 0-1.412-.587T3 19v-4q0-.825.588-1.412T5 13h14q.825 0 1.413.588T21 15v4q0 .825-.587 1.413T19 21zm0-2h14v-4H5zM5 9V5zm0 10v-4z"},null,-1)]))}const Ye=j({name:"material-symbols-splitscreen-outline",render:Xe}),xe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function et(r,s){return n(),_("svg",xe,s[0]||(s[0]=[u("path",{fill:"currentColor",d:"M5 11q-.825 0-1.412-.587T3 9V5q0-.825.588-1.412T5 3h4q.825 0 1.413.588T11 5v4q0 .825-.587 1.413T9 11zm0 10q-.825 0-1.412-.587T3 19v-4q0-.825.588-1.412T5 13h4q.825 0 1.413.588T11 15v4q0 .825-.587 1.413T9 21zm10-10q-.825 0-1.412-.587T13 9V5q0-.825.588-1.412T15 3h4q.825 0 1.413.588T21 5v4q0 .825-.587 1.413T19 11zm0 10q-.825 0-1.412-.587T13 19v-4q0-.825.588-1.412T15 13h4q.825 0 1.413.588T21 15v4q0 .825-.587 1.413T19 21zM5 9h4V5H5zm10 0h4V5h-4zm0 10h4v-4h-4zM5 19h4v-4H5zM9 9"},null,-1)]))}const tt=j({name:"material-symbols-grid-view-outline-rounded",render:et}),ot={class:"button-group"},ne=K({__name:"ViewToggleButtons",props:{cardView:{type:Boolean}},emits:["update:cardView"],setup(r){const s=r,l=M(()=>s.cardView);return(c,a)=>{const d=tt,g=Ye;return n(),_("div",ot,[u("button",{class:G({selected:!l.value}),onClick:a[0]||(a[0]=p=>c.$emit("update:cardView",!1))},[w(d)],2),u("button",{class:G({selected:l.value}),onClick:a[1]||(a[1]=p=>c.$emit("update:cardView",!0))},[w(g)],2)])}}}),nt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function it(r,s){return n(),_("svg",nt,s[0]||(s[0]=[u("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.587 1.413T20 20zm0-2h7V6H4zm9 0h7V6h-7zm5.25-3q.325 0 .538-.213T19 14.25t-.213-.537t-.537-.213h-3.5q-.325 0-.537.213T14 14.25t.213.538t.537.212zm0-2.5q.325 0 .538-.213T19 11.75t-.213-.537T18.25 11h-3.5q-.325 0-.537.213T14 11.75t.213.538t.537.212zm0-2.5q.325 0 .538-.213T19 9.25t-.213-.537t-.537-.213h-3.5q-.325 0-.537.213T14 9.25t.213.538t.537.212zM4 18V6z"},null,-1)]))}const st=j({name:"material-symbols-chrome-reader-mode-outline-rounded",render:it}),rt=K({__name:"UIModeToggleButton",props:{mode:{},tooltip:{}},emits:["click"],setup(r,{emit:s}){const l=s;return(c,a)=>{const d=st,g=ke,p=J,f=Z("tooltip");return I((n(),y(p,{onClick:a[0]||(a[0]=B(C=>l("click"),["stop"]))},{default:m(()=>[c.mode==="edit"?(n(),y(d,{key:0})):(n(),y(g,{key:1}))]),_:1})),[[f,c.tooltip]])}}}),lt=["onClick"],at=["onClick"],ht=K({__name:"MediaPageActions",props:{placement:{},uiMode:{},filterTrash:{type:Boolean},isPhone:{type:Boolean},checked:{type:Boolean},uploadMenuVisible:{type:Boolean},moreMenuVisible:{type:Boolean},sortBy:{},sortItems:{},showViewToggle:{type:Boolean},cardView:{type:Boolean},onToggleUiMode:{type:Function},onUploadFiles:{type:Function},onUploadDir:{type:Function},onOpenKeyboardShortcuts:{type:Function},onSort:{type:Function},onUpdateCardView:{type:Function}},emits:["update:uploadMenuVisible","update:moreMenuVisible"],setup(r,{emit:s}){const l=r,c=s,a=M({get:()=>l.uploadMenuVisible,set:e=>c("update:uploadMenuVisible",e)}),d=M({get:()=>l.moreMenuVisible,set:e=>c("update:moreMenuVisible",e)}),g=()=>{},p=l.onToggleUiMode??g,f=l.onUploadFiles??g,C=l.onUploadDir??g,S=l.onOpenKeyboardShortcuts??g,P=l.onUpdateCardView??g,H=M(()=>l.cardView??!1);return(e,t)=>{const k=Ve,V=J,N=be,R=Te,U=Z("tooltip");return e.placement==="top"?(n(),_(z,{key:0},[e.uiMode==="edit"&&!e.filterTrash&&(!e.isPhone||!e.checked)?(n(),y(N,{key:0,modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=o=>a.value=o)},{trigger:m(()=>[I((n(),y(V,null,{default:m(()=>[w(k)]),_:1})),[[U,e.$t("upload")]])]),default:m(()=>[u("div",{class:"dropdown-item",onClick:t[0]||(t[0]=B(o=>{$(f)(),a.value=!1},["stop"]))},v(e.$t("upload_files")),1),u("div",{class:"dropdown-item",onClick:t[1]||(t[1]=B(o=>{$(C)(),a.value=!1},["stop"]))},v(e.$t("upload_folder")),1)]),_:1},8,["modelValue"])):F("",!0),e.filterTrash?F("",!0):(n(),y(rt,{key:1,mode:e.uiMode,tooltip:e.uiMode==="edit"?e.$t("view"):e.$t("edit"),onClick:$(p)},null,8,["mode","tooltip","onClick"])),e.checked?F("",!0):(n(),y(N,{key:2,modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=o=>d.value=o)},{trigger:m(()=>[I((n(),y(V,null,{default:m(()=>[w(R)]),_:1})),[[U,e.$t("sort")]])]),default:m(()=>[u("div",{class:"dropdown-item",onClick:t[3]||(t[3]=B(o=>{$(S)(),d.value=!1},["stop"]))},v(e.$t("keyboard_shortcuts")),1),(n(!0),_(z,null,E(e.sortItems,o=>(n(),_("div",{key:o.value,class:G(["dropdown-item",{selected:o.value===e.sortBy}]),onClick:B(O=>{e.onSort(o.value),d.value=!1},["stop"])},v(e.$t(o.label)),11,lt))),128))]),_:1},8,["modelValue"])),e.showViewToggle&&!e.isPhone?(n(),y(ne,{key:3,"card-view":H.value,"onUpdate:cardView":t[5]||(t[5]=o=>$(P)(o))},null,8,["card-view"])):F("",!0)],64)):(n(),_(z,{key:1},[e.filterTrash?(n(),y(N,{key:0,modelValue:d.value,"onUpdate:modelValue":t[7]||(t[7]=o=>d.value=o)},{trigger:m(()=>[I((n(),y(V,null,{default:m(()=>[w(R)]),_:1})),[[U,e.$t("sort")]])]),default:m(()=>[u("div",{class:"dropdown-item",onClick:t[6]||(t[6]=B(o=>{$(S)(),d.value=!1},["stop"]))},v(e.$t("keyboard_shortcuts")),1),(n(!0),_(z,null,E(e.sortItems,o=>(n(),_("div",{key:o.value,class:G(["dropdown-item",{selected:o.value===e.sortBy}]),onClick:B(O=>{e.onSort(o.value),d.value=!1},["stop"])},v(e.$t(o.label)),11,at))),128))]),_:1},8,["modelValue"])):e.showViewToggle?(n(),y(ne,{key:1,"card-view":H.value,"onUpdate:cardView":t[8]||(t[8]=o=>$(P)(o))},null,8,["card-view"])):F("",!0)],64))}}}),ut={class:"shortcuts"},ct={class:"shortcut-keys"},dt={class:"shortcut-desc"},pt=K({__name:"KeyboardShortcutsModal",props:{shortcuts:{},title:{}},setup(r){const{t:s}=X(),l=M(()=>/Mac|iPhone|iPad|iPod/.test(navigator.userAgent)),c=M(()=>l.value?"Cmd":"Ctrl");function a(){re()}return(d,g)=>{const p=ie,f=se;return n(),y(f,{onClose:a},{headline:m(()=>[Q(v(d.title||$(s)("keyboard_shortcuts")),1)]),content:m(()=>[u("div",ut,[(n(!0),_(z,null,E(d.shortcuts,C=>(n(),_("div",{key:C.keys.join("+"),class:"shortcut-item"},[u("span",ct,[(n(!0),_(z,null,E(C.keys,S=>(n(),_("kbd",{key:S,class:G({"no-style":S==="+"})},v(S==="modifier"?c.value:S),3))),128))]),u("span",dt,v($(s)(C.description)),1)]))),128))])]),actions:m(()=>[w(p,{onClick:a},{default:m(()=>[Q(v($(s)("ok")),1)]),_:1})]),_:1})}}}),yt=Y(pt,[["__scopeId","data-v-ac0e117c"]]),kt=[{keys:["Delete"],description:"delete_selected"},{keys:["modifier","+","Backspace"],description:"delete_selected"},{keys:["modifier","+","A"],description:"select_all"},{keys:["Esc"],description:"clear_selection"},{keys:["←","→"],description:"navigate_pages"},{keys:["Shift","+","Click"],description:"range_select"}];export{yt as K,ht as _,gt as c,kt as m};
