import{_ as it}from"./VPagination.vuevuetypescriptsetuptruelang-CUxocS0Q.js";import{_ as dt,u as ut,a as rt,b as mt}from"./key-events-BvodbJZZ.js";import{d as ee,c as s,O as C,o as l,a as m,ar as ct,t as i,m as re,aP as Me,r as Q,aQ as Ae,aR as Ee,aS as X,az as pt,am as _t,v as y,j as r,aC as be,k as o,I as B,B as ze,z as De,x as vt,y as ft,aT as Fe,M as Be,u as Pe,i as ye,ao as Te,ap as ge,h as z,V as k,U as w,aU as yt,as as he,$ as gt,aV as bt,Z as O,a0 as $e,H as ke,A as E,ai as Oe,T as Re,aW as Ne,au as ht,a9 as Ie,aa as qe,aq as ue,L as Qe,e as $t,s as kt,f as Ct,ad as wt,ae as Vt,av as Tt,N as Nt,g as It,w as qt,X as St,Y as Ut,a2 as Lt,ab as ne,aX as Mt,G as Se,aY as At,J as Et,aD as zt,K as Dt,a5 as Ft,C as Bt,an as Pt,ax as Ot,ac as Z,Q as Rt,R as Qt,aZ as Kt}from"./index-CVNeylfK.js";import{_ as jt}from"./AllCheckedAlert.vuevuetypescriptsetuptruelang-DIxN19qM.js";import{_ as Ke}from"./VCheckbox-CAS5zPaT.js";import{_ as Gt}from"./ListItemPhone.vuevuetypescriptsetuptruelang-Dt40ZZu2.js";import{_ as Ht}from"./call-outline-rounded-BTz4lfbx.js";import{_ as Wt,S as Xt}from"./SendSmsModal-BzdzOuZc.js";import{_ as Yt}from"./FieldId.vuevuetypescriptsetuptruelang-ebOgvwVS.js";/* empty css                                                             */const Zt={key:0,class:"contact-item selectable-card-skeleton"},Jt={class:"start"},xt={class:"number"},el=ee({__name:"ContactSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(S){return(g,f)=>{const a=dt;return g.isPhone?(l(),C(a,{key:1,"title-width":"70%",subtitles:[{width:"45%"},{width:"30%"},{width:"40%"}],"action-count":3})):(l(),s("section",Zt,[m("div",Jt,[f[0]||(f[0]=m("div",{class:"skeleton-checkbox"},null,-1)),m("span",xt,i(g.index),1)]),f[1]||(f[1]=ct('<div class="image"><div class="skeleton-image lg"></div></div><div class="title"><div class="skeleton-text lg" style="width:50%;"></div></div><div class="subtitle"><div class="skeleton-text" style="width:40%;"></div></div><div class="info"><div class="skeleton-text" style="width:180px;"></div></div><div class="actions"><div class="skeleton-text lg" style="width:120px;"></div></div><div class="time"><div class="skeleton-text" style="width:60px;"></div></div>',6))]))}}}),tl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ll(S,g){return l(),s("svg",tl,g[0]||(g[0]=[m("path",{fill:"currentColor",d:"M12 13.825L8.1 17.7q-.275.275-.687.288T6.7 17.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.213t.375-.062t.375.062t.325.213l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275zm0-6L8.1 11.7q-.275.275-.687.288T6.7 11.7q-.275-.275-.275-.7t.275-.7l4.6-4.6q.15-.15.325-.212T12 5.425t.375.063t.325.212l4.6 4.6q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275z"},null,-1)]))}const nl=re({name:"material-symbols-keyboard-double-arrow-up-rounded",render:ll}),ol={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function sl(S,g){return l(),s("svg",ol,g[0]||(g[0]=[m("path",{fill:"currentColor",d:"m12 16.175l3.9-3.875q.275-.275.688-.288t.712.288q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213l-4.6-4.6q-.275-.275-.288-.687T6.7 12.3q.275-.275.7-.275t.7.275zm0-6L15.9 6.3q.275-.275.688-.287t.712.287q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213L6.7 7.7q-.275-.275-.288-.687T6.7 6.3q.275-.275.7-.275t.7.275z"},null,-1)]))}const al=re({name:"material-symbols-keyboard-double-arrow-down-rounded",render:sl});function J(S){return Array.from({length:S},(g,f)=>f+1).concat(-1)}const oe={phoneNumberTypes:J(20),emailTypes:J(4),addressTypes:J(3),eventTypes:J(3),imTypes:J(8),websiteTypes:J(7)},il=ee({__name:"PromptModal",props:{do:{type:Function,required:!0},title:{type:String,required:!0},value:{type:String,default:""}},setup(S){const{handleSubmit:g}=Me(),f=Q(),a=S,{value:h,resetField:D,errorMessage:M}=Ae("inputValue",Ee().required()),F=g(()=>{a.do(String(h.value||"")),X()});return a.value?h.value=a.value:D(),pt(async()=>{await _t(),requestAnimationFrame(()=>{setTimeout(()=>{var $;try{document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),($=f.value)==null||$.focus()}catch(e){console.debug("Focus blocked:",e)}},100)})}),($,e)=>{const _=De,V=be,I=ze,U=Fe;return l(),C(U,{onClose:o(X)},{headline:y(()=>[B(i(S.title),1)]),content:y(()=>[r(_,{ref_key:"inputRef",ref:f,modelValue:o(h),"onUpdate:modelValue":e[0]||(e[0]=K=>ft(h)?h.value=K:null),class:"form-control",error:!!o(M),"error-text":o(M)?$.$t(o(M)):"",onKeyup:vt(o(F),["enter"])},null,8,["modelValue","error","error-text","onKeyup"])]),actions:y(()=>[r(V,{value:"cancel",onClick:o(X)},{default:y(()=>[B(i($.$t("cancel")),1)]),_:1},8,["onClick"]),r(I,{value:"ok",onClick:o(F)},{default:y(()=>[B(i($.$t("ok")),1)]),_:1},8,["onClick"])]),_:1},8,["onClose"])}}}),dl={class:"form-label"},ul={class:"form-row"},rl={key:1,class:"v-center"},ml={key:0,class:"form-row"},cl={class:"v-center"},pl={class:"form-label"},_l={class:"v-center"},vl=["onClick"],fl={key:1,class:"form-label"},yl={class:"v-center"},gl=["onClick"],bl={key:2,class:"form-label"},hl={class:"v-center"},$l=["onClick"],kl={key:3,class:"form-label"},Cl={class:"v-center"},wl=["onClick"],Vl={key:4,class:"form-label"},Tl={class:"v-center"},Nl=["onClick"],Il={class:"form-row",style:{display:"block",position:"relative"}},ql={class:"form-row"},Ue=ee({__name:"EditContactModal",props:{data:{type:Object,default:()=>({})},sources:{type:Array,default:()=>[]},done:{type:Function,default:()=>{}}},setup(S){const{handleSubmit:g}=Me(),f=S,a=Be({firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",nickname:"",organization:null,notes:"",source:"",starred:0,phoneNumbers:[],emails:[],addresses:[],websites:[],events:[],ims:[],groupIds:[]}),h=Q(!1),D=Q(!1),{t:M}=Pe(),{mutate:F,loading:$,onDone:e}=ye({document:ge`
    mutation createContact($input: ContactInput!) {
      createContact(input: $input) {
        ...ContactFragment
      }
    }
    ${Te}
  `,options:{update:()=>{f.done()}}}),{mutate:_,loading:V,onDone:I}=ye({document:ge`
    mutation updateContact($id: ID!, $input: ContactInput!) {
      updateContact(id: $id, input: $input) {
        ...ContactFragment
      }
    }
    ${Te}
  `,options:{update:()=>{f.done()}}}),{value:U,resetField:K,errorMessage:te}=Ae("inputValue",Ee().test("required",n=>"valid.required",n=>!0).test("target-value",n=>"invalid_value",n=>!0)),A=(n,c)=>{n.splice(0,n.length);for(const v of c)n.push({label:v.label,value:v.value,type:v.type})};(()=>{const n=f.data;n?(Object.assign(a,{firstName:n.firstName,middleName:n.middleName,lastName:n.lastName,prefix:n.prefix,suffix:n.suffix,notes:n.notes}),A(a.phoneNumbers,n.phoneNumbers),A(a.emails,n.emails),A(a.addresses,n.addresses),A(a.websites,n.websites),A(a.events,n.events),A(a.ims,n.ims)):(Object.assign(a,{firstName:"",middleName:"",lastName:"",prefix:"",suffix:"",notes:"",phoneNumbers:[{type:2,value:"",label:""}],emails:[],addresses:[],websites:[],events:[],ims:[]}),K())})();const L=n=>{n.type===-1&&bt(il,{value:n.label,title:M("custom"),do:c=>{n.label=c}})},Y=(n,c,v)=>c===-1?n.label?n.label:M("custom"):M(`contact.${v}.${c}`),T=(n,c,v)=>n.map(j=>({value:j,label:Y(v,j,c)})),t=n=>{n.push({type:1,value:"",label:""}),D.value=!1},q=(n,c)=>{n.splice(c,1)},R=g(()=>{var n,c;f.data?_({id:f.data.id,input:a}):(a.source=((c=(n=f.sources)==null?void 0:n[0])==null?void 0:c.name)??"",F({input:a}))});return e(()=>{X()}),I(()=>{X()}),(n,c)=>{const v=De,j=al,me=nl,G=yt,H=he,se=be,ce=gt,ae=ze,ie=Fe;return l(),C(ie,{onClose:o(X)},{headline:y(()=>[B(i(S.data?n.$t("edit"):n.$t("create")),1)]),content:y(()=>[m("label",dl,i(n.$t("name")),1),m("div",ul,[r(v,{modelValue:a.firstName,"onUpdate:modelValue":c[0]||(c[0]=d=>a.firstName=d),label:n.$t("first_name")},null,8,["modelValue","label"]),h.value?(l(),C(v,{key:0,modelValue:a.middleName,"onUpdate:modelValue":c[1]||(c[1]=d=>a.middleName=d),label:n.$t("middle_name")},null,8,["modelValue","label"])):z("",!0),r(v,{modelValue:a.lastName,"onUpdate:modelValue":c[2]||(c[2]=d=>a.lastName=d),label:n.$t("last_name")},null,8,["modelValue","label"]),h.value?z("",!0):(l(),s("div",rl,[m("button",{class:"btn-icon",onClick:c[3]||(c[3]=d=>h.value=!0)},[r(j)])]))]),h.value?(l(),s("div",ml,[r(v,{modelValue:a.prefix,"onUpdate:modelValue":c[4]||(c[4]=d=>a.prefix=d),label:n.$t("prefix")},null,8,["modelValue","label"]),r(v,{modelValue:a.suffix,"onUpdate:modelValue":c[5]||(c[5]=d=>a.suffix=d),label:n.$t("suffix")},null,8,["modelValue","label"]),m("div",cl,[m("button",{class:"btn-icon",onClick:c[6]||(c[6]=d=>h.value=!1)},[r(me)])])])):z("",!0),m("label",pl,i(n.$t("phone_number")),1),(l(!0),s(k,null,w(a.phoneNumbers,(d,N)=>(l(),s("div",{key:N,class:"form-row"},[r(G,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:T(o(oe).phoneNumberTypes,"phone_number_type",d),onChange:p=>L(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:n.$t("telephone"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),m("div",_l,[a.phoneNumbers.length>1?(l(),s("button",{key:0,class:"btn-icon",onClick:p=>q(a.phoneNumbers,N)},[r(H)],8,vl)):z("",!0)])]))),128)),a.emails.length?(l(),s("label",fl,i(n.$t("email")),1)):z("",!0),(l(!0),s(k,null,w(a.emails,(d,N)=>(l(),s("div",{key:N,class:"form-row"},[r(G,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:T(o(oe).emailTypes,"email_type",d),onChange:p=>L(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,label:n.$t("email"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),m("div",yl,[m("button",{class:"btn-icon",onClick:p=>q(a.emails,N)},[r(H)],8,gl)])]))),128)),a.addresses.length?(l(),s("label",bl,i(n.$t("address")),1)):z("",!0),(l(!0),s(k,null,w(a.addresses,(d,N)=>(l(),s("div",{key:N,class:"form-row"},[r(G,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:T(o(oe).addressTypes,"address_type",d),onChange:p=>L(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,label:n.$t("address"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","label"]),m("div",hl,[m("button",{class:"btn-icon",onClick:p=>q(a.addresses,N)},[r(H)],8,$l)])]))),128)),a.websites.length?(l(),s("label",kl,i(n.$t("website")),1)):z("",!0),(l(!0),s(k,null,w(a.websites,(d,N)=>(l(),s("div",{key:N,class:"form-row"},[r(G,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:T(o(oe).websiteTypes,"website_type",d),onChange:p=>L(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:n.$t("website"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),m("div",Cl,[m("button",{class:"btn-icon",onClick:p=>q(a.websites,N)},[r(H)],8,wl)])]))),128)),a.ims.length?(l(),s("label",Vl,i(n.$t("im")),1)):z("",!0),(l(!0),s(k,null,w(a.ims,(d,N)=>(l(),s("div",{key:N,class:"form-row"},[r(G,{modelValue:d.type,"onUpdate:modelValue":p=>d.type=p,modelModifiers:{number:!0},class:"flex-2",options:T(o(oe).imTypes,"im_type",d),onChange:p=>L(d)},null,8,["modelValue","onUpdate:modelValue","options","onChange"]),r(v,{modelValue:d.value,"onUpdate:modelValue":p=>d.value=p,placeholder:n.$t("im"),class:"flex-3"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),m("div",Tl,[m("button",{class:"btn-icon",onClick:p=>q(a.ims,N)},[r(H)],8,Nl)])]))),128)),m("div",Il,[r(ce,{modelValue:D.value,"onUpdate:modelValue":c[12]||(c[12]=d=>D.value=d),placement:"auto",align:"top-left-to-bottom-left"},{trigger:y(()=>[r(se,null,{default:y(()=>[B(i(n.$t("add_field")),1)]),_:1})]),default:y(()=>[m("div",{class:"dropdown-item",onClick:c[7]||(c[7]=()=>t(a.phoneNumbers))},i(n.$t("phone_number")),1),m("div",{class:"dropdown-item",onClick:c[8]||(c[8]=()=>t(a.emails))},i(n.$t("email")),1),m("div",{class:"dropdown-item",onClick:c[9]||(c[9]=()=>t(a.addresses))},i(n.$t("address")),1),m("div",{class:"dropdown-item",onClick:c[10]||(c[10]=()=>t(a.websites))},i(n.$t("website")),1),m("div",{class:"dropdown-item",onClick:c[11]||(c[11]=()=>t(a.ims))},i(n.$t("im")),1)]),_:1},8,["modelValue"])]),m("div",ql,[r(v,{modelValue:a.notes,"onUpdate:modelValue":c[13]||(c[13]=d=>a.notes=d),type:"textarea",label:n.$t("notes"),rows:3},null,8,["modelValue","label"])])]),actions:y(()=>[r(se,{value:"cancel",onClick:o(X)},{default:y(()=>[B(i(n.$t("cancel")),1)]),_:1},8,["onClick"]),r(ae,{value:"save",loading:o($)||o(V),onClick:o(R)},{default:y(()=>[B(i(n.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),Sl={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ul(S,g){return l(),s("svg",Sl,g[0]||(g[0]=[m("path",{fill:"currentColor",d:"M12 14q.825 0 1.413-.587T14 12t-.587-1.412T12 10t-1.412.588T10 12t.588 1.413T12 14m-4 4h8v-.575q0-.6-.325-1.1t-.9-.75q-.65-.275-1.338-.425T12 15t-1.437.15t-1.338.425q-.575.25-.9.75T8 17.425zm10 4H6q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V20q0 .825-.587 1.413T18 22m0-2V8.85L13.15 4H6v16zM6 20V4z"},null,-1)]))}const Ll=re({name:"material-symbols-contact-page-outline-rounded",render:Ul}),Ml={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Al(S,g){return l(),s("svg",Ml,g[0]||(g[0]=[m("path",{fill:"currentColor",d:"M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"},null,-1)]))}const El=re({name:"material-symbols-edit",render:Al}),zl={class:"actions"},Le=ee({__name:"ContactActionButtons",props:{item:{}},emits:["deleteItem","edit","addItemToTags"],setup(S,{emit:g}){const f=S,a=g;function h(){a("deleteItem",f.item)}function D(){a("edit",f.item)}function M(){a("addItemToTags",f.item)}return(F,$)=>{const e=he,_=ke,V=El,I=Oe,U=$e("tooltip");return l(),s("div",zl,[O((l(),C(_,{onClick:E(h,["stop"])},{default:y(()=>[r(e)]),_:1})),[[U,F.$t("delete")]]),O((l(),C(_,{onClick:E(D,["stop"])},{default:y(()=>[r(V)]),_:1})),[[U,F.$t("edit")]]),O((l(),C(_,{onClick:E(M,["stop"])},{default:y(()=>[r(I)]),_:1})),[[U,F.$t("add_to_tags")]])])}}}),Dl={class:"start"},Fl={class:"number"},Bl=["src"],Pl={class:"title"},Ol={class:"subtitle"},Rl={key:0},Ql={class:"info"},Kl={class:"list-unstyled"},jl={class:"time"},Gl=["src"],Hl={class:"subtitle"},Wl={key:0},Xl={class:"info"},Yl={class:"list-unstyled"},Zl={class:"time"},Jl=ee({__name:"ContactListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},dataType:{},callLoading:{type:Boolean},callId:{},callIndex:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function}},emits:["deleteItem","edit","addItemToTags","sendSms","call"],setup(S,{emit:g}){const f=g;function a(e){f("deleteItem",e)}function h(e){f("edit",e)}function D(e){f("addItemToTags",e)}function M(e,_,V){f("call",e,_,V)}function F(e,_,V){f("sendSms",e,_,V)}function $(e){let _="";ue(e.firstName)||ue(e.lastName)?_=`${e.lastName}${e.middleName}${e.firstName}`:_=[e.firstName,e.middleName,e.lastName].filter(U=>U).join(" ");const V=e.suffix?`, ${e.suffix}`:"",I=`${e.prefix} ${_} ${V}`.trim();return I||(e.emails.length?e.emails[0].value:"")}return(e,_)=>{const V=Ke,I=Yt,U=Ll,K=ht,te=Wt,A=ke,L=Ht,Y=Gt,T=$e("tooltip");return e.isPhone?(l(),C(Y,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:_[4]||(_[4]=t=>e.handleItemClick(t,e.item,e.index,()=>{})),onMouseenter:_[5]||(_[5]=E(t=>e.handleMouseOver(t,e.index),["stop"])),onCheckboxClick:_[6]||(_[6]=t=>e.toggleSelect(t,e.item,e.index))},{image:y(()=>[e.item.thumbnailId?(l(),s("img",{key:0,class:"image",src:o(Ne)(e.item.thumbnailId),width:"50"},null,8,Gl)):(l(),C(U,{key:1,class:"image"}))]),title:y(()=>[B(i($(e.item)),1)]),subtitle:y(()=>[m("div",Hl,[e.item.notes?(l(),s("span",Wl,i(e.item.notes),1)):z("",!0),r(K,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),m("div",Xl,[m("ul",Yl,[(l(!0),s(k,null,w(e.item.phoneNumbers,(t,q)=>(l(),s("li",{key:q,class:"phone-number"},[B(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),O((l(),C(A,{onClick:E(R=>F(e.item.id,t.normalizedNumber||t.value,q),["stop"])},{default:y(()=>[r(te)]),_:2},1032,["onClick"])),[[T,e.$t("send_sms")]]),O((l(),C(A,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===q,onClick:E(R=>M(e.item.id,t.normalizedNumber||t.value,q),["stop"])},{default:y(()=>[r(L)]),_:2},1032,["loading","onClick"])),[[T,e.$t("make_a_phone_call")]])]))),128)),(l(!0),s(k,null,w(e.item.emails,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.addresses,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.websites,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.ims,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.events,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),m("div",Zl,[O((l(),s("span",null,[B(i(o(qe)(e.item.updatedAt)),1)])),[[T,o(Ie)(e.item.updatedAt)]])])]),actions:y(()=>[r(Le,{item:e.item,onDeleteItem:a,onEdit:h,onAddItemToTags:D},null,8,["item"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(l(),s("section",{key:0,class:Re(["contact-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:_[2]||(_[2]=E(t=>e.handleItemClick(t,e.item,e.index,()=>{}),["stop"])),onMouseenter:_[3]||(_[3]=E(t=>e.handleMouseOver(t,e.index),["stop"]))},[m("div",Dl,[e.shiftEffectingIds.includes(e.item.id)?(l(),C(V,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:_[0]||(_[0]=E(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])):(l(),C(V,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:_[1]||(_[1]=E(t=>e.toggleSelect(t,e.item,e.index),["stop"]))},null,8,["checked"])),m("span",Fl,[r(I,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),e.item.thumbnailId?(l(),s("img",{key:0,class:"image",src:o(Ne)(e.item.thumbnailId),width:"50"},null,8,Bl)):(l(),C(U,{key:1,class:"image"})),m("div",Pl,i($(e.item)),1),m("div",Ol,[e.item.notes?(l(),s("span",Rl,i(e.item.notes),1)):z("",!0),r(K,{tags:e.item.tags,type:e.dataType,"only-links":!0},null,8,["tags","type"])]),m("div",Ql,[m("ul",Kl,[(l(!0),s(k,null,w(e.item.phoneNumbers,(t,q)=>(l(),s("li",{key:q,class:"phone-number"},[B(i(t.type>0?e.$t(`contact.phone_number_type.${t.type}`):t.label)+" "+i(t.normalizedNumber||t.value)+" ",1),O((l(),C(A,{onClick:E(R=>F(e.item.id,t.normalizedNumber||t.value,q),["stop"])},{default:y(()=>[r(te)]),_:2},1032,["onClick"])),[[T,e.$t("send_sms")]]),O((l(),C(A,{loading:e.callLoading&&e.callId===e.item.id&&e.callIndex===q,onClick:E(R=>M(e.item.id,t.normalizedNumber||t.value,q),["stop"])},{default:y(()=>[r(L)]),_:2},1032,["loading","onClick"])),[[T,e.$t("make_a_phone_call")]])]))),128)),(l(!0),s(k,null,w(e.item.emails,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.email_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.addresses,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.address_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.websites,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.website_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.ims,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.im_type.${t.type}`):t.label)+" "+i(t.value),1))),128)),(l(!0),s(k,null,w(e.item.events,t=>(l(),s("li",{key:t.type+t.value},i(t.type>0?e.$t(`contact.event_type.${t.type}`):t.label)+" "+i(t.value),1))),128))])]),r(Le,{item:e.item,onDeleteItem:a,onEdit:h,onAddItemToTags:D},null,8,["item"]),m("div",jl,[O((l(),s("span",null,[B(i(o(qe)(e.item.updatedAt)),1)])),[[T,o(Ie)(e.item.updatedAt)]])])],34))}}}),xl=Qe(Jl,[["__scopeId","data-v-69df6ea0"]]),en={class:"top-app-bar"},tn={class:"title"},ln={key:0},nn={key:1},on={class:"actions"},sn={class:"scroll-content"},an={key:0,class:"no-data-placeholder"},x=50,dn=ee({__name:"ContactsView",setup(S){const g=Dt("isPhone"),f=$t(),{app:a}=kt(Ct()),h=Q([]),{t:D}=Pe(),{parseQ:M}=Qt(),F=Be({tagIds:[]}),$=wt.CONTACT,e=Ft(),_=Q(1),V=Q([]),I=Q(""),{tags:U,fetch:K}=Vt($),{addToTags:te}=Tt($,U),{deleteItems:A}=ut(Kt,()=>{R(),p(),Z.emit("refetch_tags",$)}),{selectedIds:L,allChecked:Y,realAllChecked:T,selectRealAll:t,allCheckedAlertVisible:q,clearSelection:R,toggleAllChecked:n,toggleSelect:c,total:v,checked:j,shiftEffectingIds:me,handleItemClick:G,handleMouseOver:H,selectAll:se,shouldSelect:ce}=rt(h),ae=u=>{const b=e.query.q;Bt(f,b?`/contacts?page=${u}&q=${b}`:`/contacts?page=${u}`)},{keyDown:ie,keyUp:d}=mt(v,x,_,se,R,ae,()=>{A(L.value,T.value,v.value,I.value)}),{loading:N,fetch:p}=Nt({handle:(u,b)=>{b?Se(D(b),"error"):u&&(h.value=u.contacts,v.value=u.contactCount)},document:Mt,variables:()=>({offset:(_.value-1)*x,limit:x,query:I.value})});It({handle:(u,b)=>{b?Se(D(b),"error"):u&&(V.value=u.contactSources)},document:At,variables:null});const Ce=u=>{u.type===$&&(R(),p())},we=u=>{u.type===$&&p()};function je(u){ne(Pt,{type:$,tags:U.value,item:{key:u.id,title:"",size:0},selected:U.value.filter(b=>u.tags.some(P=>P.id===b.id))})}function Ge(u){let b="";ue(u.firstName)||ue(u.lastName)?b=`${u.lastName}${u.middleName}${u.firstName}`:b=[u.firstName,u.middleName,u.lastName].filter(le=>le).join(" ");const P=u.suffix?`, ${u.suffix}`:"",de=`${u.prefix} ${b} ${P}`.trim();return de||(u.emails.length?u.emails[0].value:"")}function He(u){ne(Ot,{id:u.id,name:Ge(u),gql:ge`
      mutation DeleteContact($query: String!) {
        deleteContacts(query: $query)
      }
    `,variables:()=>({query:`ids:${u.id}`}),typeName:"Contact",done:()=>{v.value--,u.tags.length&&Z.emit("refetch_tags",$)}})}function We(u){ne(Ue,{data:u,sources:V,done:p})}function Xe(){ne(Ue,{data:null,sources:V,done:p})}const pe=Q(""),_e=Q(0),{mutate:Ye,loading:Ze}=ye({document:Et});function Je(u,b,P){pe.value=u,_e.value=P,Ye({number:b})}function xe(u,b,P){pe.value=u,_e.value=P,ne(Xt,{number:b})}const ve=Q(!1);function Ve(){var b,P;const u=parseInt(((b=e.query.page)==null?void 0:b.toString())??"1");_.value=Number.isFinite(u)&&u>0?u:1,I.value=Rt(((P=e.query.q)==null?void 0:P.toString())??""),M(F,I.value),p()}return qt(()=>e.fullPath,()=>{ve.value&&Ve()}),St(()=>{K(),ve.value=!0,Ve(),Z.on("item_tags_updated",we),Z.on("items_tags_updated",Ce),window.addEventListener("keydown",ie),window.addEventListener("keyup",d)}),Ut(()=>{ve.value=!1,Z.off("item_tags_updated",we),Z.off("items_tags_updated",Ce),window.removeEventListener("keydown",ie),window.removeEventListener("keyup",d)}),(u,b)=>{const P=Ke,de=he,le=ke,et=zt,tt=Oe,lt=be,nt=jt,ot=el,st=it,fe=$e("tooltip");return l(),s(k,null,[m("div",en,[r(P,{"touch-target":"wrapper",checked:o(Y),indeterminate:!o(Y)&&o(j),onChange:o(n)},null,8,["checked","indeterminate","onChange"]),m("div",tn,[o(L).length?(l(),s("span",ln,i(u.$t("x_selected",{count:o(T)?o(v).toLocaleString():o(L).length.toLocaleString()})),1)):(l(),s("span",nn,i(u.$t("page_title.contacts"))+" ("+i(o(v).toLocaleString())+")",1)),o(j)?(l(),s(k,{key:2},[O((l(),C(le,{onClick:b[0]||(b[0]=E(W=>o(A)(o(L),o(T),o(v),I.value),["stop"]))},{default:y(()=>[r(de)]),_:1})),[[fe,u.$t("delete")]]),O((l(),C(le,{style:{display:"none"}},{default:y(()=>[r(et)]),_:1})),[[fe,u.$t("download")]]),O((l(),C(le,{onClick:b[1]||(b[1]=E(W=>o(te)(o(L),o(T),I.value),["stop"]))},{default:y(()=>[r(tt)]),_:1})),[[fe,u.$t("add_to_tags")]])],64)):z("",!0)]),m("div",on,[r(lt,{class:"btn-sm",onClick:Xe},{default:y(()=>[B(i(u.$t("create")),1)]),_:1})])]),r(nt,{limit:x,total:o(v),"all-checked-alert-visible":o(q),"real-all-checked":o(T),"select-real-all":o(t),"clear-selection":o(R)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),m("div",sn,[m("div",{class:Re(["main-list",{"select-mode":o(j)}])},[(l(!0),s(k,null,w(h.value,(W,at)=>(l(),C(xl,{key:W.id,item:W,index:at,"selected-ids":o(L),"shift-effecting-ids":o(me),"should-select":o(ce),"is-phone":o(g),"data-type":o($),"call-loading":o(Ze),"call-id":pe.value,"call-index":_e.value,"handle-item-click":o(G),"handle-mouse-over":o(H),"toggle-select":o(c),onDeleteItem:He,onEdit:We,onAddItemToTags:je,onSendSms:xe,onCall:Je},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","data-type","call-loading","call-id","call-index","handle-item-click","handle-mouse-over","toggle-select"]))),128)),o(N)&&h.value.length===0?(l(),s(k,{key:0},w(20,W=>r(ot,{key:W,index:W,"is-phone":o(g)},null,8,["index","is-phone"])),64)):z("",!0)],2),!o(N)&&h.value.length===0?(l(),s("div",an,i(u.$t(o(Lt)(o(N),o(a).permissions,"WRITE_CONTACTS"))),1)):z("",!0),o(v)>x?(l(),C(st,{key:1,page:_.value,go:ae,total:o(v),limit:x},null,8,["page","total"])):z("",!0)])],64)}}}),bn=Qe(dn,[["__scopeId","data-v-e0575a7c"]]);export{bn as default};
