import{d as N,aH as j,r as q,aI as z,cH as H,i as k,cI as K,cJ as R,M as C,o as m,v as r,j as v,I as f,t as i,k as o,aK as y,an as E,B as J,a as p,O,R as b,c as Y,a1 as P,cK as U,a0 as W,cL as X,au as Z,aL as x,a7 as h,c0 as ee,L as ae,u as $,Y as te,bs as se,G as L,a5 as oe}from"./index-CiJYwD0I.js";const ne={class:"button-group"},le=N({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=j(),t=q("add_to_tags"),a=d,{value:s,errorMessage:n}=z("selectedTags",H().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:I}=k({document:K}),{mutate:M,loading:A,onDone:S}=k({document:R}),T=()=>{h.emit("items_tags_updated",{type:a.type}),h.emit("refetch_tags",a.type),y()};S(T),I(T);function B(e){s.value.includes(e)?ee(s.value,c=>c.id===e.id):s.value.push(e)}const D=_(()=>{t.value==="add_to_tags"?M({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):l({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,c)=>{const F=U,G=X,Q=E,V=J,w=x;return m(),C(w,{onClose:o(y)},{headline:r(()=>[f(i(e.$t("tags")),1)]),content:r(()=>[p("div",ne,[p("button",{class:b({selected:t.value==="add_to_tags"}),onClick:c[0]||(c[0]=u=>t.value="add_to_tags")},i(e.$t("add_to_tags")),3),p("button",{class:b({selected:t.value==="remove_from_tags"}),onClick:c[1]||(c[1]=u=>t.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),v(G,null,{default:r(()=>[(m(!0),Y(W,null,P(d.tags,u=>(m(),C(F,{key:u.id,label:u.name,selected:o(s).includes(u),onClick:ce=>B(u)},null,8,["label","selected","onClick"]))),128))]),_:1}),O(p("div",{class:"invalid-feedback"},i(o(n)?e.$t(o(n)):""),513),[[Z,o(n)]])]),actions:r(()=>[v(Q,{value:"cancel",onClick:o(y)},{default:r(()=>[f(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),v(V,{value:"save",loading:o(A)||o(g),onClick:o(D)},{default:r(()=>[f(i(e.$t("save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["onClose"])}}}),de=ae(le,[["__scopeId","data-v-8725492b"]]),re=(d,_)=>{const{t}=$();return{addToTags:(a,s,n)=>{let l=n;if(!s){if(a.length===0){L(t("select_first"),"error");return}l=`ids:${a.join(",")}`}oe(de,{type:d,tags:_.value,query:l})}}},ie=(d,_=()=>{})=>{const t=q([]),{t:a}=$(),{loading:s,fetch:n}=te({handle:async(l,g)=>{g?L(a(g),"error"):l&&(t.value=l.tags,_())},document:se,variables:{type:d}});return{tags:t,loading:s,fetch:n}};export{re as a,ie as u};
