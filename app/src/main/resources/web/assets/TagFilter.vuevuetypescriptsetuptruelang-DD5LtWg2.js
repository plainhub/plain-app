import{_ as z}from"./VDropdownMenu-CxTbhC5S.js";import{_ as j}from"./more-vert-CEF7zZdM.js";import{m as A,c as m,o as s,a as o,d as F,u as P,e as R,r as _,g as U,bs as O,G as J,ai as K,a7 as u,aj as W,j as v,I as X,O as b,t as d,P as Y,M as V,H as Z,A as g,v as f,a0 as M,a1 as ee,R as te,a5 as h,bS as q,ag as ae,D as ne,C as oe,cw as se,E as ie,i as B,cx as le,cy as de,cz as re}from"./index-CiJYwD0I.js";const ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ue(p,n){return s(),m("svg",ce,n[0]||(n[0]=[o("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const me=A({name:"material-symbols-add-rounded",render:ue}),pe={class:"section-title"},_e={class:"nav"},ve=["onClick"],ge={class:"title"},fe={class:"count"},we=F({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(p){const n=p,{t:i}=P(),E=R(),y=_([]),l=_(!1),r=_(),{refetch:c}=U({handle:(e,t)=>{t?J(i(t),"error"):e&&(y.value=e.tags)},document:O,variables:{type:n.type}});function S(e){r.value=e;const t=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:t}})),l.value=!0}function L(e){h(q,{title:i("rename"),placeholder:i("name"),value:e.name,mutation:()=>B({document:le}),getVariables:t=>({id:e.id,name:t}),done:()=>{c()}})}function Q(e){h(ae,{id:e.id,name:e.name,gql:de,typeName:"Tag"})}function D(){h(q,{title:i("add_tag"),placeholder:i("name"),mutation:()=>B({document:re,options:{update:()=>{c()}}}),getVariables:e=>({type:n.type,name:e})})}function G(e){const t=ne([{name:"tag_id",op:"",value:e.id}]);oe(E,`/${se[n.type]}?q=${ie(t)}`)}const T=e=>{e===n.type&&c()},w=e=>{e.type===n.type&&c()};return K(()=>{u.on("refetch_tags",T),u.on("media_items_actioned",w)}),W(()=>{u.off("refetch_tags",T),u.off("media_items_actioned",w)}),(e,t)=>{var k;const I=me,C=Z,H=j,N=z,$=Y("tooltip");return s(),m(M,null,[o("div",pe,[X(d(e.$t("tags"))+" ",1),b((s(),V(C,{onClick:g(D,["prevent"])},{default:f(()=>[v(I)]),_:1})),[[$,e.$t("add_tag")]])]),o("ul",_e,[(s(!0),m(M,null,ee(y.value,a=>(s(),m("li",{key:a.id,class:te({active:a.id===p.selected}),onClick:g(x=>G(a),["prevent"])},[o("span",ge,d(a.name),1),b((s(),V(C,{id:"tag-"+a.id,class:"sm",onClick:g(x=>S(a),["prevent","stop"])},{default:f(()=>[v(H)]),_:2},1032,["id","onClick"])),[[$,e.$t("actions")]]),o("span",fe,d(a.count.toLocaleString()),1)],10,ve))),128))]),v(N,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value=a),anchor:"tag-"+((k=r.value)==null?void 0:k.id)},{default:f(()=>[o("div",{class:"dropdown-item",onClick:t[0]||(t[0]=a=>{L(r.value),l.value=!1})},d(e.$t("rename")),1),o("div",{class:"dropdown-item",onClick:t[1]||(t[1]=a=>{Q(r.value),l.value=!1})},d(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{we as _,me as a};
